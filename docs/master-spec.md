# TargetBot ‚Äî –ü–æ–ª–Ω–æ–µ –¢–ó, —Ç–µ–∫—Å—Ç—ã –∏ –º–∞—Å—Ç–µ—Ä-–ø—Ä–æ–º–ø—Ç

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç "–∂–∏—Ä–Ω–æ–µ" –¢–ó, —à–∞–±–ª–æ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –º–∞—Å—Ç–µ—Ä-–ø—Ä–æ–º–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å Codex'—É/–ò–ò-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É –¥–ª—è –¥–æ–≤–µ–¥–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –¥–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è. –û–ø–∏—Ä–∞—Ç—å—Å—è –Ω—É–∂–Ω–æ –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É Cloudflare Worker + Telegram Bot + Web Portal –∏ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.

## 0. –û–±—â–∏–µ —É—Å–ª–æ–≤–∏—è

* **–ù–∏–∫–∞–∫–∏—Ö –Ω–æ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è**. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —É–∂–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –≤ `.env`/Wrangler:
  - `DEFAULT_TZ`, `ADMIN_IDS`, `ADMIN_ID`
  - `BOT_TOKEN`, `TELEGRAM_BOT_TOKEN`, `TELEGRAM_SECRET`
  - `WORKER_URL` (`th-reports.buyclientuz.workers.dev`)
  - `CLOUD_FLARE_API_TOKEN`, `CLOUD_FLARE_AC_ID`
  - `FB_APP_ID`, `FB_APP_SECRET`, `FB_LONG_TOKEN`
  - `R2_ACCESS_KEY_ID`, `R2_SECRET_ACCESS_KEY`, `R2_BUCKET_NAME`, `R2_ACCOUNT_ID`, `R2_ENDPOINT`

* **Webhook Telegram**: `https://${WORKER_URL}/tg-webhook?secret=${TELEGRAM_SECRET}`.
* **–ü–æ—Ä—Ç–∞–ª –ø—Ä–æ–µ–∫—Ç–∞**: `https://${WORKER_URL}/p/{projectId}?token=...`.
* **–ü–æ—Ä—Ç–∞–ª/REST API**: –ª—é–±—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ `/api/projects/:id/summary`, `/leads/:period`, `/leads/:period/refresh`, `/campaigns` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω —á–µ—Ä–µ–∑ `period=custom&from=YYYY-MM-DD&to=YYYY-MM-DD` –∏ –æ–±—è–∑–∞–Ω—ã –æ—Ç–¥–∞–≤–∞—Ç—å —Ä–æ–≤–Ω–æ —Ç–µ –∂–µ –º–µ—Ç—Ä–∏–∫–∏, —á—Ç–æ –∏ Ads Manager –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –¥–∞—Ç—ã.

## 1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

### 1.1. Workers KV ‚Äî –±—ã—Å—Ç—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ namespaces –∏ —Ä–æ–≤–Ω–æ —Ç–∞–∫–∏–µ –∫–ª—é—á–∏/—Ñ–æ—Ä–º–∞—Ç—ã:

* `facebook-auth:{userId}` (–∏ –∑–µ—Ä–∫–∞–ª—å–Ω—ã–π –∞–ª–∏–∞—Å `fb_auth:{userId}` –¥–ª—è –ª–µ–≥–∞—Å–∏-–∫–ª—é—á–µ–π)

```json
{
  "user_id": 7623982602,
  "access_token": "EAAG...",
  "expires_at": "2026-01-13T08:23:00Z",
  "ad_accounts": [
    {
      "id": "act_813372877848886",
      "name": "birlash",
      "currency": "USD"
    }
  ]
}
```

* `projects_by_user:{userId}`

```json
{
  "projects": ["proj_birlash_1", "proj_client_2"]
}
```

* `project:{projectId}`

```json
{
  "id": "proj_birlash_1",
  "name": "birlash",
  "owner_id": 7623982602,
  "ad_account_id": "act_813372877848886",
  "chat_id": -1003269756488,
  "portal_url": "https://th-reports.buyclientuz.workers.dev/p/proj_birlash_1",
  "settings": {
    "currency": "USD",
    "timezone": "Asia/Tashkent",
    "kpi": {
      "mode": "auto",
      "type": "LEAD",
      "label": "–õ–∏–¥—ã"
    }
  }
}
```

* `billing:{projectId}`

```json
{
  "tariff": 500,
  "currency": "USD",
  "next_payment_date": "2025-12-15",
  "autobilling": true
}
```

```

* `autoreports:{projectId}`

```json
{
  "enabled": true,
  "time": "10:00",
  "mode": "yesterday_plus_week",
  "send_to_chat": true,
  "send_to_admin": false,
  "payment_alerts": {
    "enabled": false,
    "send_to_chat": true,
    "send_to_admin": true,
    "last_account_status": null,
    "last_alert_at": null
  }
}
```

### 1.2. R2 ‚Äî —Ç—è–∂—ë–ª—ã–µ –¥–∞–Ω–Ω—ã–µ

–í—Å—ë —Ö—Ä–∞–Ω–∏—Ç—å –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º –±–∞–∫–µ—Ç–µ `R2_BUCKET_NAME`:

* `project-leads/{projectId}/list.json`

```json
{
  "stats": {
    "total": 168,
    "today": 2
  },
  "leads": [
    {
      "id": "lead_1",
      "name": "Farhod",
      "phone": "+998...",
      "created_at": "2025-11-14T16:35:00Z",
      "source": "Facebook",
      "campaign_name": "BirLash –õ–∏–¥—ã",
      "status": "new"
    }
  ]
}
```

* `project-leads/{projectId}/{leadId}.json` ‚Äî –ø–æ–ª–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –ª–∏–¥–∞.
* `meta/campaigns/{projectId}.json`

```json
{
  "period": {
    "from": "2025-11-15",
    "to": "2025-11-15"
  },
  "summary": {
    "spend": 17.28,
    "impressions": 6500,
    "clicks": 120,
    "leads": 5,
    "messages": 8
  },
  "campaigns": [
    {
      "id": "123",
      "name": "BirLash –õ–∏–¥—ã",
      "objective": "LEAD_GENERATION",
      "kpi_type": "LEAD",
      "spend": 10.5,
      "impressions": 3200,
      "clicks": 60,
      "leads": 3,
      "messages": 0
    }
  ]
}
```

* `payments/{projectId}/history.json`

```json
{
  "payments": [
    {
      "id": "pay_1",
      "amount": 500,
      "currency": "USD",
      "period_from": "2025-11-15",
      "period_to": "2025-12-15",
      "paid_at": "2025-11-15T18:11:00Z",
      "status": "paid",
      "comment": "–û–ø–ª–∞—Ç–∞ –∑–∞ –º–µ—Å—è—Ü"
    }
  ]
}
```

## 2. Telegram-–±–æ—Ç ‚Äî —Ç–µ–∫—Å—Ç—ã –∏ –¥–µ–π—Å—Ç–≤–∏—è

### 2.1. –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é `/start`

–°–æ–æ–±—â–µ–Ω–∏–µ:

```
–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª: –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, –ø—Ä–æ–µ–∫—Ç—ã, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏–ª–∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.
```

Reply-–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞:
1. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è Facebook
2. –ü—Ä–æ–µ–∫—Ç—ã
3. –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
5. –§–∏–Ω–∞–Ω—Å—ã
6. –í–µ–±—Ö—É–∫–∏ Telegram
7. –ù–∞—Å—Ç—Ä–æ–π–∫–∏

### 2.2. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è Facebook

**–ï—Å–ª–∏ —Ç–æ–∫–µ–Ω–∞ –Ω–µ—Ç** ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—Å—Ç —Å–æ —Å—Å—ã–ª–∫–æ–π –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏, –æ—Ç–∫—Ä—ã—Ç—å OAuth-—Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø—Ä–∏–Ω—è—Ç—å —Ç–æ–∫–µ–Ω —Å–æ–æ–±—â–µ–Ω–∏–µ–º, –∑–∞–ø–∏—Å–∞—Ç—å –≤ `facebook-auth:{userId}` (–ø–ª—é—Å `fb_auth:{userId}` –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏) –∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ.

**–ï—Å–ª–∏ —Ç–æ–∫–µ–Ω –µ—Å—Ç—å** ‚Äî –≤—ã–≤–µ—Å—Ç–∏ —Å—Ç–∞—Ç—É—Å, –¥–∞—Ç—É –∏—Å—Ç–µ—á–µ–Ω–∏—è, –∫–Ω–æ–ø–∫–∏ `üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Ç–æ–∫–µ–Ω`, `üì¶ –°–ø–∏—Å–æ–∫ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤`, `‚¨ÖÔ∏è –ù–∞–∑–∞–¥`.

–ö–Ω–æ–ø–∫–∞ ¬´–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è Facebook¬ª –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç `https://${WORKER_URL}/api/meta/oauth/start?tid={telegramUserId}` ‚Äî –ø—Ä—è–º–æ–π OAuth-flow —Å —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–º –Ω–∞ `https://www.facebook.com/v18.0/dialog/oauth`. HTML-—Å—Ç—Ä–∞–Ω–∏—Ü–∞ `/fb-auth` –æ—Å—Ç–∞—ë—Ç—Å—è –∫–∞–∫ –ø–æ–¥—Å–∫–∞–∑–∫–∞, –Ω–æ –Ω–µ –æ—Å–Ω–æ–≤–Ω–æ–π –≤—Ö–æ–¥.

### 2.3. –ü—Ä–æ–µ–∫—Ç—ã

* –ß–∏—Ç–∞—Ç—å `projects_by_user:{userId}`.
* –ï—Å–ª–∏ –ø—É—Å—Ç–æ ‚Äî —Å–æ–æ–±—â–∏—Ç—å, —á—Ç–æ –ø—Ä–æ–µ–∫—Ç–æ–≤ –Ω–µ—Ç.
* –ò–Ω–∞—á–µ ‚Äî —Å–ø–∏—Å–æ–∫ –≤–∏–¥–∞ `1Ô∏è‚É£ birlash [14,78 $]` (–∑–∞—Ç—Ä–∞—Ç—ã –∑–∞ —Å–µ–≥–æ–¥–Ω—è –∏–∑ summary.spend), –∫–Ω–æ–ø–∫–∏: –∫–∞–∂–¥—ã–π –ø—Ä–æ–µ–∫—Ç, `‚ûï –ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç`, `‚¨ÖÔ∏è –ù–∞–∑–∞–¥`.

### 2.4. –ö–∞—Ä—Ç–æ—á–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

–°–æ–æ–±—â–µ–Ω–∏–µ —Å –ø–æ–ª—è–º–∏ Meta, CPA, –ª–∏–¥—ã, –æ–ø–ª–∞—Ç–∞, –∞–≤—Ç–æ–±–∏–ª–ª–∏–Ω–≥, –∞–≤—Ç–æ–æ—Ç—á—ë—Ç—ã, —á–∞—Ç, –ø–æ—Ä—Ç–∞–ª. CPA = spend_today / KPI (–Ω–∞–ø—Ä–∏–º–µ—Ä leads). –§–æ—Ä–º–∞—Ç —Ç–µ–∫—Å—Ç–∞ —Å—Ç—Ä–æ–≥–æ –∫–∞–∫ –≤ –¢–ó.

Inline-–∫–Ω–æ–ø–∫–∏:
`‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ`, `üì≤ –ß–∞—Ç-–≥—Ä—É–ø–ø–∞`, `üîÅ –ò–∑–º–µ–Ω–∏—Ç—å —á–∞—Ç-–≥—Ä—É–ø–ø—É`, `üö´ –û—Ç–≤—è–∑–∞—Ç—å —á–∞—Ç`, `üí¨ –õ–∏–¥—ã`, `üìà –û—Ç—á—ë—Ç –ø–æ —Ä–µ–∫–ª–∞–º–µ`, `üëÄ –†–µ–∫–ª–∞–º–Ω—ã–µ –∫–∞–º–ø–∞–Ω–∏–∏`, `üì§ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö`, `üß© –ü–æ—Ä—Ç–∞–ª`, `üí≥ –û–ø–ª–∞—Ç–∞`, `üïí –ê–≤—Ç–æ-–æ—Ç—á—ë—Ç—ã`, `‚öô –ò–∑–º–µ–Ω–∏—Ç—å KPI –ø—Ä–æ–µ–∫—Ç–∞`, `üß® –£–¥–∞–ª–∏—Ç—å`, `‚¨ÖÔ∏è –ö —Å–ø–∏—Å–∫—É`, `üè† –ú–µ–Ω—é`.

## 3. –õ–æ–≥–∏–∫–∞ –ø–æ –∫–Ω–æ–ø–∫–∞–º

### 3.1. `‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ`

–ü–æ–∫–∞–∑–∞—Ç—å –º–µ–Ω—é –≤—ã–±–æ—Ä–∞ –ø–æ–ª—è (–Ω–∞–∑–≤–∞–Ω–∏–µ, —Ä–µ–∫–ª–∞–º–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç, –≤–ª–∞–¥–µ–ª–µ—Ü). –ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –æ–∂–∏–¥–∞—Ç—å –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –æ–±–Ω–æ–≤–ª—è—Ç—å `project:{projectId}`.

### 3.2. `üì≤ –ß–∞—Ç-–≥—Ä—É–ø–ø–∞`

–ï—Å–ª–∏ `chat_id` –µ—Å—Ç—å ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å —Å—Å—ã–ª–∫—É, ID –∏ –∫–Ω–æ–ø–∫–∏ `üîÅ –ò–∑–º–µ–Ω–∏—Ç—å`, `üö´ –û—Ç–≤—è–∑–∞—Ç—å`, `‚¨ÖÔ∏è –ù–∞–∑–∞–¥`. –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –ø—Ä–∏–≤—è–∑–∞—Ç—å —á–∞—Ç.

### 3.3. `üîÅ –ò–∑–º–µ–Ω–∏—Ç—å —á–∞—Ç-–≥—Ä—É–ø–ø—É`

–°–æ–æ–±—â–µ–Ω–∏–µ —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ (–≤—ã–±—Ä–∞—Ç—å –∏–∑ —Å–ø–∏—Å–∫–∞ —Å–≤–æ–±–æ–¥–Ω—ã—Ö —á–∞—Ç–æ–≤ –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É/ID). Inline-–∫–Ω–æ–ø–∫–∏: —Å–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤, `üîó –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ —á–∞—Ç –≤—Ä—É—á–Ω—É—é`, `‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ –ø—Ä–æ–µ–∫—Ç—É`. –ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å `chat_id` –∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å.

### 3.4. `üö´ –û—Ç–≤—è–∑–∞—Ç—å —á–∞—Ç`

–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–∞–º–∏ `‚úÖ –î–∞, –æ—Ç–≤—è–∑–∞—Ç—å`, `‚¨ÖÔ∏è –û—Ç–º–µ–Ω–∞`. –ü—Ä–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏ ‚Äî `chat_id = null`, —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–º –æ—Ç–≤—è–∑—ã–≤–∞–Ω–∏–∏.

### 3.5. `üí¨ –õ–∏–¥—ã`

–ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ (–¥–∞—Ç—ã `from/to`), ¬´–í—Å–µ–≥–æ –∑–∞ –ø–µ—Ä–∏–æ–¥¬ª –∏ ¬´–°–µ–≥–æ–¥–Ω—è¬ª. –ù–∏–∂–µ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å—Ç—Ä–æ–∫–æ–π –≤—ã–≤–æ–¥–∏—Ç—Å—è
¬´–ó–∞ –≤—Å—ë –≤—Ä–µ–º—è: X | –°–µ–≥–æ–¥–Ω—è: Y¬ª, —á—Ç–æ–±—ã –≤–∏–¥–Ω–æ –±—ã–ª–æ –æ–±—â–∏–π –æ–±—ä—ë–º –∑–∞—è–≤–æ–∫ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ñ–∏–ª—å—Ç—Ä–∞. –ü–∞–Ω–µ–ª—å —Å–æ–¥–µ—Ä–∂–∏—Ç:

- —Ä—è–¥ —Ñ–∏–ª—å—Ç—Ä–æ–≤ —Å—Ç–∞—Ç—É—Å–æ–≤ (`üÜï`, `‚è≥`, `‚úÖ`, `üóë`) —Å –±–µ–π–¥–∂–∞–º–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞—è–≤–æ–∫;
- —Ä—è–¥ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –ø–µ—Ä–∏–æ–¥–æ–≤ (`–°–µ–≥–æ–¥–Ω—è`, `–ù–µ–¥–µ–ª—è`, `–ú–µ—Å—è—Ü`, `–í—Å–µ –≤—Ä–µ–º—è`), –∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–µ–∫–ª—é—á–∞—é—Ç `project:leads:{status}:{projectId}:{periodKey}` –∏ –ø–æ–¥–≥—Ä—É–∂–∞—é—Ç –ª–∏–¥—ã –ø—Ä—è–º–æ –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞;
- –∫–Ω–æ–ø–∫—É `üìÖ –£–∫–∞–∑–∞—Ç—å –¥–∞—Ç—ã`, –∫–æ—Ç–æ—Ä–∞—è —Å—Ç–∞–≤–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ä–µ–∂–∏–º –≤–≤–æ–¥–∞ (`project:leads-range:{status}:{projectId}`) –∏ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–≤–∞ –∑–Ω–∞—á–µ–Ω–∏—è `YYYY-MM-DD`/`DD.MM.YYYY`, —Å–æ—Ö—Ä–∞–Ω—è—è –∫–∞—Å—Ç–æ–º–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω (`periodKey=custom`);
- —Å–ø–∏—Å–æ–∫ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∫–∞—Ä—Ç–æ—á–µ–∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞ (5‚Äì10 —à—Ç.) —Å –∏–º–µ–Ω–µ–º, –∫–æ–Ω—Ç–∞–∫—Ç–æ–º, –¥–∞—Ç–æ–π/–≤—Ä–µ–º–µ–Ω–µ–º, –∫–∞–º–ø–∞–Ω–∏–µ–π –∏ ¬´–≤ –æ—á–µ—Ä–µ–¥–∏ —É–∂–µ N –º–∏–Ω—É—Ç¬ª –¥–ª—è `new`.

`üì§ –≠–∫—Å–ø–æ—Ä—Ç –ª–∏–¥–æ–≤` –≤—ã–≥—Ä—É–∂–∞–µ—Ç CSV –∏–º–µ–Ω–Ω–æ –∑–∞ –∞–∫—Ç–∏–≤–Ω—ã–π –ø–µ—Ä–∏–æ–¥ (–≤–∫–ª—é—á–∞—è –∫–∞—Å—Ç–æ–º–Ω—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã). –ö–Ω–æ–ø–∫–∏ –∫–∞—Ä—Ç–æ—á–∫–∏: `‚úÖ –ó–∞–≤–µ—Ä—à–∏—Ç—å`, `‚è≥ –í –æ–±—Ä–∞–±–æ—Ç–∫–µ`, `üóë –í –∫–æ—Ä–∑–∏–Ω—É`, `üìû –ü–æ–∑–≤–æ–Ω–µ–Ω / –ù–∞–ø–∏—Å–∞–Ω`, `‚¨ÖÔ∏è –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É`.

**–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –ª–∏–¥–∞—Ö** —É–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞: –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –≤ —Ä–∞–∑–¥–µ–ª–µ ¬´–õ–∏–¥—ã¬ª –¥–æ—Å—Ç—É–ø–Ω—ã –¥–≤–∞ —á–µ–∫–±–æ–∫—Å–∞ ‚Äî ¬´–í —á–∞—Ç¬ª –∏ ¬´–ê–¥–º–∏–Ω—É¬ª, –∞ –≤ Telegram-–ø–∞–Ω–µ–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞ –≤ —Ä–∞–∑–¥–µ–ª–µ ¬´–õ–∏–¥—ã¬ª –µ—Å—Ç—å –∫–Ω–æ–ø–∫–∏ ¬´üë• –ß–∞—Ç ‚Äî –≤–∫–ª/–≤—ã–∫–ª¬ª –∏ ¬´üë§ –ê–¥–º–∏–Ω ‚Äî –≤–∫–ª/–≤—ã–∫–ª¬ª. –í—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –º–∞–ø—è—Ç—Å—è –Ω–∞ `project-settings.leads.sendToChat` / `sendToAdmin` –∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç, –∫—É–¥–∞ Meta-webhook –æ—Ç–ø—Ä–∞–≤–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ ¬´üîî –õ–∏–¥ –æ–∂–∏–¥–∞–µ—Ç –æ—Ç–≤–µ—Ç–∞¬ª. –ï—Å–ª–∏ –æ–±–∞ –≤—ã–∫–ª—é—á–µ–Ω—ã, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è.

**–û–ø–ª–∞—Ç—ã**: —Ç–∞–±–ª–∏—Ü–∞ –∏—Å—Ç–æ—Ä–∏–∏ (`payments/.../history.json`) –≤ –∞–¥–º–∏–Ω–∫–µ —Ç–µ–ø–µ—Ä—å —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç–æ–ª–±–µ—Ü ¬´–î–µ–π—Å—Ç–≤–∏—è¬ª —Å –∫–Ω–æ–ø–∫–∞–º–∏ ¬´–ò–∑–º–µ–Ω–∏—Ç—å¬ª –∏ ¬´–£–¥–∞–ª–∏—Ç—å¬ª. –ö–ª–∏–∫ –ø–æ ¬´–ò–∑–º–µ–Ω–∏—Ç—å¬ª –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Ñ–æ—Ä–º—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–ª–∞—Ç–µ–∂–∞ (–ø–æ–ª—è —Å—É–º–º–∞, –≤–∞–ª—é—Ç–∞, –ø–µ—Ä–∏–æ–¥, –¥–∞—Ç–∞ –æ–ø–ª–∞—Ç—ã, —Å—Ç–∞—Ç—É—Å, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π) –∏ –≤–∫–ª—é—á–∞–µ—Ç —Ä–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å –∫–Ω–æ–ø–∫–æ–π ¬´–û—Ç–º–µ–Ω–∏—Ç—å¬ª. ¬´–£–¥–∞–ª–∏—Ç—å¬ª –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –¥–∞—Ç—É –ø–ª–∞—Ç–µ–∂–∞ (—Ñ–æ—Ä–º–∞—Ç—ã `DD.MM.YYYY` –∏–ª–∏ `YYYY-MM-DD`) –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `DELETE /projects/:id/payments/:paymentId` —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –¥–∞—Ç–∞ —Å–æ–≤–ø–∞–¥–∞–µ—Ç. –ù–∏–∂–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω –±–ª–æ–∫ ¬´–ë—ã—Å—Ç—Ä—ã–π –≤–≤–æ–¥ –æ–ø–ª–∞—Ç¬ª ‚Äî –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –≤–∏–¥–∞ `500 18.11.2025 –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ` –∏–ª–∏ `700 2025-12-01 –û–ø–ª–∞—á–µ–Ω–æ`; backend –ø–∞—Ä—Å–∏—Ç —Å—Ç—Ä–æ–∫–∏, –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏ –ø–æ `periodTo` –∏–ª–∏ —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–µ, –∞ —Å—Ç–∞—Ç—É—Å—ã –Ω–æ—Ä–º–∞–ª–∏–∑—É—é—Ç—Å—è (`–û–ø–ª–∞—á–µ–Ω–æ` ‚Üí `paid`, `–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ` ‚Üí `overdue`, –∏ —Ç. –¥.). –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–∏—à—É—Ç –≤ R2 –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–≤–∏–≥–∞—é—Ç `billing.nextPaymentDate`.

### 3.6. `üìà –û—Ç—á—ë—Ç –ø–æ —Ä–µ–∫–ª–∞–º–µ`

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `meta/campaigns/{projectId}.json`. –¢–µ–∫—Å—Ç:

```
–û—Ç—á—ë—Ç –ø–æ —Ä–µ–∫–ª–∞–º–µ ‚Äî {project.name}
–ü–µ—Ä–∏–æ–¥: –≤—á–µ—Ä–∞ + –Ω–µ–¥–µ–ª—è

üí∞ –ó–∞—Ç—Ä–∞—Ç—ã: {spend} {currency}
üëÄ –ü–æ–∫–∞–∑–æ–≤: {impressions}
üëÜ –ö–ª–∏–∫–æ–≤: {clicks}
üéØ KPI: {kpi_label} ‚Äî {kpi_value}
üìä CPA: {cpa} {currency}

–¢–æ–ø-3 –∫–∞–º–ø–∞–Ω–∏–∏ –ø–æ KPI:
1Ô∏è‚É£ ...
```

–ö–Ω–æ–ø–∫–∏: `üìÖ –ò–∑–º–µ–Ω–∏—Ç—å –ø–µ—Ä–∏–æ–¥`, `‚öô –ù–∞—Å—Ç—Ä–æ–π–∫–∏ KPI`, `‚¨ÖÔ∏è –ù–∞–∑–∞–¥`.

### 3.7. `üì§ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö`

–ö–Ω–æ–ø–∫–∏: `üí¨ –õ–∏–¥—ã (CSV)`, `üìà –ö–∞–º–ø–∞–Ω–∏–∏ (CSV)`, `üí≥ –û–ø–ª–∞—Ç—ã (CSV)`, `‚¨ÖÔ∏è –ù–∞–∑–∞–¥`. –û—Ç–≤–µ—Ç ‚Äî —Ñ–∞–π–ª + —Ç–µ–∫—Å—Ç ¬´–í–æ—Ç –≤–∞—à —ç–∫—Å–ø–æ—Ä—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ CSV¬ª.

### 3.8. `üí≥ –û–ø–ª–∞—Ç–∞`

–ß–∏—Ç–∞—Ç—å `billing:{projectId}` –∏ `payments/{projectId}/history.json`. –°–æ–æ–±—â–µ–Ω–∏–µ —Å —Ç–∞—Ä–∏—Ñ–æ–º, –¥–∞—Ç–æ–π –ø–ª–∞—Ç–µ–∂–∞, —Å—Ç–∞—Ç—É—Å–æ–º –∞–≤—Ç–æ–±–∏–ª–ª–∏–Ω–≥–∞, –∏—Å—Ç–æ—Ä–∏—è (–µ—Å–ª–∏ –µ—Å—Ç—å). –ö–Ω–æ–ø–∫–∏: `üìÖ +30 –¥–Ω–µ–π`, `350$`, `500$`, `üìÖ –£–∫–∞–∑–∞—Ç—å –¥–∞—Ç—É –æ–ø–ª–∞—Ç—ã`, `‚úèÔ∏è –í–≤–µ—Å—Ç–∏ –¥–∞—Ç—É –≤—Ä—É—á–Ω—É—é`, `‚¨ÖÔ∏è –ù–∞–∑–∞–¥`. –ü—Ä–∏ –æ–∂–∏–¥–∞–Ω–∏–∏ –¥–∞—Ç—ã –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–∞—Ä—Å–∏—Ç—Å—è (—Ñ–æ—Ä–º–∞—Ç—ã `DD.MM.YYYY` –∏–ª–∏ `YYYY-MM-DD`). –û–±–Ω–æ–≤–∏—Ç—å KV –∏ –∏—Å—Ç–æ—Ä–∏—é –æ–ø–ª–∞—Ç. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤–∏–¥–∞ ¬´‚úÖ –î–∞—Ç–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø–ª–∞—Ç–µ–∂–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞: 15.12.2025¬ª.

### 3.9. `üïí –ê–≤—Ç–æ-–æ—Ç—á—ë—Ç—ã`

–°–æ–æ–±—â–µ–Ω–∏–µ —Å —Ç–µ–∫—É—â–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –∏–∑ `autoreports:{projectId}`. –ö–Ω–æ–ø–∫–∏: `‚úÖ –í–∫–ª—é—á–∏—Ç—å / ‚õîÔ∏è –í—ã–∫–ª—é—á–∏—Ç—å`, `üïí –ò–∑–º–µ–Ω–∏—Ç—å –≤—Ä–µ–º—è`, `üë• –ß–∞—Ç ‚Äî –≤–∫–ª/–≤—ã–∫–ª`, `üë§ –ê–¥–º–∏–Ω ‚Äî –≤–∫–ª/–≤—ã–∫–ª`, `üí≥ –ê–ª–ª–µ—Ä—Ç –æ–ø–ª–∞—Ç ‚Äî –≤–∫–ª/–≤—ã–∫–ª`, `üë• –ê–ª–ª–µ—Ä—Ç: —á–∞—Ç`, `üë§ –ê–ª–ª–µ—Ä—Ç: –∞–¥–º–∏–Ω`, `‚¨ÖÔ∏è –ù–∞–∑–∞–¥`.

### 3.10. `‚öô –ò–∑–º–µ–Ω–∏—Ç—å KPI –ø—Ä–æ–µ–∫—Ç–∞`

–°–æ–æ–±—â–µ–Ω–∏–µ —Å —Ä–µ–∂–∏–º–æ–º –∏ —Ç–∏–ø–æ–º KPI. –ö–Ω–æ–ø–∫–∏: `ü§ñ –ê–≤—Ç–æ-—Ä–µ–∂–∏–º`, `üìù –†—É—á–Ω–æ–π –≤—ã–±–æ—Ä`, `üéØ –õ–∏–¥—ã`, `üí¨ –°–æ–æ–±—â–µ–Ω–∏—è`, `üëÜ –ö–ª–∏–∫–∏`, `üëÄ –ü—Ä–æ—Å–º–æ—Ç—Ä—ã`, `üõí –ü–æ–∫—É–ø–∫–∏`, `‚¨ÖÔ∏è –ù–∞–∑–∞–¥`.

### 3.11. `üß® –£–¥–∞–ª–∏—Ç—å`

–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è —Å –∫–Ω–æ–ø–∫–∞–º–∏ `üß® –î–∞, —É–¥–∞–ª–∏—Ç—å –ø—Ä–æ–µ–∫—Ç`, `‚¨ÖÔ∏è –û—Ç–º–µ–Ω–∞`. –ü—Ä–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏ —É–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å–∏ KV/R2 –∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å ¬´‚úÖ –ü—Ä–æ–µ–∫—Ç —É–¥–∞–ª—ë–Ω¬ª.

## 4. –ê–≤—Ç–æ–æ—Ç—á—ë—Ç—ã

### 4.1. –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∏ —Ñ–æ—Ä–º–∞—Ç—ã

* `autoreports:{projectId}` —Ö—Ä–∞–Ω–∏—Ç `enabled`, `time`, `mode`, `send_to_chat`, `send_to_admin` –∏ –æ–±—ä–µ–∫—Ç `payment_alerts`.
* `payment_alerts` –≤–∫–ª—é—á–∞–µ—Ç `enabled`, `send_to_chat`, `send_to_admin`, `last_account_status`, `last_alert_at`. –ï—Å–ª–∏ `payment_alerts.enabled = true`, –≤–æ—Ä–∫–µ—Ä –Ω–∞ –∫–∞–∂–¥–æ–º –ø—Ä–æ—Ö–æ–¥–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å —Ä–µ–∫–ª–∞–º–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞; –ø—Ä–∏ –∫–æ–¥–∞—Ö `2/3/7/11/13` (¬´UNSETTLED/IN_GRACE/PENDING_SETTLEMENT¬ª) –æ–¥–∏–Ω —Ä–∞–∑ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –≤ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã –∏ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç `last_account_status`. –ü—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ –±–∏–ª–ª–∏–Ω–≥–∞ —Ñ–ª–∞–≥ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è, —Å–ª–µ–¥—É—é—â–∏–π –±–ª–æ–∫ —Å–Ω–æ–≤–∞ –ø—Ä–∏–≤–µ–¥—ë—Ç –∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—é.
* –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–ª–æ—Ç—ã –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç; –ø—Ä–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–∏ –∏ –≤–∫–ª—é—á—ë–Ω–Ω–æ–º —Ñ–ª–∞–≥–µ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –æ—Ç—á—ë—Ç –∑–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–π –≤—á–µ—Ä–∞—à–Ω–∏–π –¥–µ–Ω—å (–∞ –ø–æ –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫–∞–º –¥–æ–±–∞–≤–ª—è–µ—Ç –±–ª–æ–∫ ¬´–≤—á–µ—Ä–∞ + –Ω–µ–¥–µ–ª—è¬ª).
* –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–µ –∂–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã: –±–ª–æ–∫–∏ ¬´–í—á–µ—Ä–∞/–ü–æ–∑–∞–≤—á–µ—Ä–∞¬ª –≤—Å–µ–≥–¥–∞ –æ–ø–∏—Å—ã–≤–∞—é—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å—É—Ç–∫–∏ –∏ –∏—Ö —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ, —á—Ç–æ–±—ã –Ω–µ –±—Ä–∞—Ç—å —á–∞—Å—Ç–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–µ–∫—É—â–µ–≥–æ –¥–Ω—è.
* –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –∫–∞—Ä—Ç–æ—á–∫—É –ø–æ—Ä—Ç–∞–ª–∞: —Ä–∞—Å—Ö–æ–¥, –ª–∏–¥—ã, CPA, CTR, –∫–ª–∏–∫–∏, —Ç–æ–ø –∫–∞–º–ø–∞–Ω–∏–π. –í–Ω–∏–∑—É –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ—Ä—Ç–∞–ª –∏ –∫–Ω–æ–ø–∫–∞ ¬´üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–µ–π—á–∞—Å¬ª –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞.
* –¶–µ–ª—å –æ—Ç—á—ë—Ç–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏: –µ—Å–ª–∏ –≤ —Å—É–º–º–µ –µ—Å—Ç—å –ª–∏–¥—ã ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ¬´–õ–∏–¥—ã¬ª, –∏–Ω–∞—á–µ ¬´–°–æ–æ–±—â–µ–Ω–∏—è¬ª, –∞ –¥–∞–ª—å—à–µ –≤—ã–±–æ—Ä –∏–¥—ë—Ç –ø–æ —Ü–µ–ª—è–º –∫–∞–º–ø–∞–Ω–∏–π –∏ fallback KPI.
* –î–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Ç-–≥—Ä—É–ø–ø—ã –±–ª–æ–∫ ¬´–í—ã–≤–æ–¥¬ª —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è, –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –ø–æ–ª—É—á–∞–µ—Ç –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏.
* –ï—Å–ª–∏ —É –ø—Ä–æ–µ–∫—Ç–∞ –Ω–µ –∑–∞–¥–∞–Ω timezone, –∞–≤—Ç–æ–æ—Ç—á—ë—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `Asia/Tashkent`.

### 4.2. –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫

* –ö–Ω–æ–ø–∫–∞ `üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–µ–π—á–∞—Å` –≤ –º–µ–Ω—é –∞–≤—Ç–æ–æ—Ç—á—ë—Ç–æ–≤ –≤—ã–∑—ã–≤–∞–µ—Ç `auto_send_now:{projectId}` –∏ —Å—Ä–∞–∑—É –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç—á—ë—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è.
* –ü—Ä–∏ —É—Å–ø–µ—Ö–µ –±–æ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç ¬´–û—Ç—á—ë—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω¬ª. –û—à–∏–±–∫–∏ Telegram –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

## 5. –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π –ø–æ—Ä—Ç–∞–ª

* –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ `/p/{projectId}?token=...` –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –º–æ–¥–∞–ª—å–Ω—ã–π –ø—Ä–µ–ª–æ–∞–¥–µ—Ä ¬´–ì–æ—Ç–æ–≤–∏–º –¥–∞–Ω–Ω—ã–µ‚Ä¶ –≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 3‚Äì5 —Å–µ–∫—É–Ω–¥¬ª.
* JS –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ:
  - `/api/project/{projectId}?token=...`
  - `/api/billing/{projectId}?token=...`
  - `/api/campaigns/{projectId}?token=...`
  - `/api/leads/{projectId}?token=...`
* –¢–∞–π–º–∞—É—Ç 10‚Äì15 —Å–µ–∫—É–Ω–¥: –ø—Ä–∏ –æ—à–∏–±–∫–µ —Å–∫—Ä—ã—Ç—å –ø—Ä–µ–ª–æ–∞–¥–µ—Ä –∏ –ø–æ–∫–∞–∑–∞—Ç—å ¬´–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ. [–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ–ø—ã—Ç–∫—É]¬ª.
* –í–µ—Ä—Ö–Ω–∏–π –±–ª–æ–∫ ¬´–ö–ª—é—á–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏¬ª: —Ä–∞—Å—Ö–æ–¥, –ø–æ–∫–∞–∑—ã, –∫–ª–∏–∫–∏, KPI, –ª–∏–¥—ã –≤—Å–µ–≥–æ, –Ω–æ–≤—ã–µ –ª–∏–¥—ã.
* –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–æ–≤: –ò–º—è, –¢–µ–ª–µ—Ñ–æ–Ω, –¢–∏–ø, –î–∞—Ç–∞, –†–µ–∫–ª–∞–º–∞. –ù–∞–¥ —Ç–∞–±–ª–∏—Ü–µ–π –ø–æ–∫–∞–∑–∞–Ω—ã –¥–≤–∞ —Å—á—ë—Ç—á–∏–∫–∞ ‚Äî ¬´–í—Å–µ–≥–æ –∑–∞ –ø–µ—Ä–∏–æ–¥ / –°–µ–≥–æ–¥–Ω—è¬ª –∏ ¬´–ó–∞ –≤—Å—ë
  –≤—Ä–µ–º—è / –°–µ–≥–æ–¥–Ω—è¬ª; –¥–∞–Ω–Ω—ã–µ –±–µ—Ä—É—Ç—Å—è –∏–∑ `periodStats` –∏ `stats`, –∞ —ç–∫—Å–ø–æ—Ä—Ç –ª–∏–¥–æ–≤ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω (–≤–∫–ª—é—á–∞—è –∫–∞—Å—Ç–æ–º–Ω—ã–µ
  –¥–∞—Ç—ã).
* –¢–∞–±–ª–∏—Ü–∞ –∫–∞–º–ø–∞–Ω–∏–π: –ù–∞–∑–≤–∞–Ω–∏–µ, –°—Ç–∞—Ç—É—Å, –¶–µ–ª—å, –ü–æ–∫–∞–∑–∞—Ç–µ–ª—å, –†–∞—Å—Ö–æ–¥, –ü–æ–∫–∞–∑–æ–≤, –ö–ª–∏–∫–∏.
* –ë–ª–æ–∫ –æ–ø–ª–∞—Ç—ã: —Ç–µ–∫—É—â–∏–π —Ç–∞—Ä–∏—Ñ (`billing`), –¥–∞—Ç–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø–ª–∞—Ç–µ–∂–∞, –∏—Å—Ç–æ—Ä–∏—è –æ–ø–ª–∞—Ç (`payments/.../history.json`).

## 6. –¢–∞–±–ª–∏—Ü–∞ ¬´–ö–æ–º–∞–Ω–¥–∞ ‚Üí –¥–∞–Ω–Ω—ã–µ ‚Üí —Å–æ–±—ã—Ç–∏—è¬ª

–ü—Ä–∏–º–µ—Ä—ã (–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ –≤—Å–µ–º –∫–æ–º–∞–Ω–¥–∞–º):

```
–ö–û–ú–ê–ù–î–ê: "–ü—Ä–æ–µ–∫—Ç—ã"
–î–ê–ù–ù–´–ï:
  - kv.get("projects_by_user:{userId}")
  - –¥–ª—è –∫–∞–∂–¥–æ–≥–æ projectId: kv.get("project:{projectId}")
  - R2.get("meta/campaigns/{projectId}.json") –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è spend_today
–°–û–ë–´–¢–ò–ï:
  - –ø–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å —Ç–µ–∫—É—â–∏–º–∏ –∑–∞—Ç—Ä–∞—Ç–∞–º–∏ –∑–∞ —Å–µ–≥–æ–¥–Ω—è
  - –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –ø—Ä–æ–µ–∫—Ç–∞ ‚Üí –ö–û–ú–ê–ù–î–ê "–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ–µ–∫—Ç"

–ö–û–ú–ê–ù–î–ê: "–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ–µ–∫—Ç"
–î–ê–ù–ù–´–ï:
  - kv.get("project:{projectId}")
  - kv.get("billing:{projectId}")
  - kv.get("autoreports:{projectId}")
  - R2.get("meta/campaigns/{projectId}.json")
  - R2.get("project-leads/{projectId}/list.json")
–°–û–ë–´–¢–ò–ï:
  - —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å CPA, –ª–∏–¥—ã —Å–µ–≥–æ–¥–Ω—è/–≤—Å–µ–≥–æ
  - –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É –ø—Ä–æ–µ–∫—Ç–∞ —Å —Ç–µ–∫—Å—Ç–æ–º –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ 2.4

–ö–û–ú–ê–ù–î–ê: "–û–ø–ª–∞—Ç–∞"
–î–ê–ù–ù–´–ï:
  - kv.get("billing:{projectId}")
  - R2.get("payments/{projectId}/history.json")
–°–û–ë–´–¢–ò–ï:
  - –ø–æ–∫–∞–∑–∞—Ç—å —ç–∫—Ä–∞–Ω –æ–ø–ª–∞—Ç—ã
  - –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–æ–∫ (+30 –¥–Ω–µ–π, 350$/500$, –≤–≤–æ–¥ –¥–∞—Ç—ã)
  - –ø—Ä–∏ –≤–≤–æ–¥–µ –¥–∞—Ç—ã –ø–∞—Ä—Å–∏—Ç—å –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å next_payment_date
  - –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–±–Ω–æ–≤–∏—Ç—å billing –∏ history, –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
```

Codex/—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –¥–æ–ª–∂–µ–Ω –¥–æ–ø–æ–ª–Ω–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥: "–õ–∏–¥—ã", "–û—Ç—á—ë—Ç –ø–æ —Ä–µ–∫–ª–∞–º–µ", "–≠–∫—Å–ø–æ—Ä—Ç", "–ê–≤—Ç–æ-–æ—Ç—á—ë—Ç—ã", "–öPI", "–£–¥–∞–ª–∏—Ç—å" –∏ —Ç. –¥.

## 7. Master Prompt –¥–ª—è Codex

–ù–∏–∂–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è Codex/–ò–ò. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –±–ª–æ–∫ —Ü–µ–ª–∏–∫–æ–º:

```
–¢—ã ‚Äî senior full-stack —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –∏ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø—Ä–æ–µ–∫—Ç Cloudflare Worker + Telegram Bot + Web Portal –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Ä–µ–∫–ª–∞–º—ã.

–í–∞–∂–Ω—ã–µ —É—Å–ª–æ–≤–∏—è:
1. –í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —É–∂–µ –µ—Å—Ç—å .env/—Å–µ–∫—Ä–µ—Ç—ã. –ù–ï–õ–¨–ó–Ø –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–ª–∏ –º–µ–Ω—è—Ç—å —Ñ–æ—Ä–º–∞—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö. –ò—Å–ø–æ–ª—å–∑—É–π: BOT_TOKEN, TELEGRAM_BOT_TOKEN, TELEGRAM_SECRET, WORKER_URL, ADMIN_IDS, ADMIN_ID, FB_APP_ID, FB_APP_SECRET, FB_LONG_TOKEN, CLOUD_FLARE_API_TOKEN, CLOUD_FLARE_AC_ID, R2_ACCESS_KEY_ID, R2_SECRET_ACCESS_KEY, R2_BUCKET_NAME, R2_ACCOUNT_ID, R2_ENDPOINT, DEFAULT_TZ.
2. –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ Cloudflare KV –∏ R2. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–æ–±–ª—é–¥–∞–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∫–ª—é—á–µ–π:
  - KV: facebook-auth:{userId} (—Å–æ–≤–º–µ—Å—Ç–∏–º–æ —Å fb_auth:{userId}), projects_by_user:{userId}, project:{projectId}, billing:{projectId}, autoreports:{projectId}.
   - R2: project-leads/{projectId}/list.json, project-leads/{projectId}/{leadId}.json, meta/campaigns/{projectId}.json, payments/{projectId}/history.json.
3. Telegram-–±–æ—Ç, –ø–æ—Ä—Ç–∞–ª –∏ Meta-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç, –Ω–æ –ª–æ–≥–∏–∫–∞ —á–∞—Å—Ç–∏—á–Ω–æ —Å–ª–æ–º–∞–Ω–∞. –ù—É–∂–Ω–æ –¥–æ–≤–µ—Å—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–æ —Ä–∞–±–æ—á–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è (–±–æ—Ç–æ–≤—ã–µ –º–µ–Ω—é, –ø–æ—Ä—Ç–∞–ª, –æ–ø–ª–∞—Ç—ã, KPI, Meta webhook, –∞–≤—Ç–æ–æ—Ç—á—ë—Ç—ã).

–ó–∞–¥–∞—á–∏:
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å/–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –∏ CRUD —Å—Ç—Ä–æ–≥–æ –ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞–º –∏–∑ –¢–ó.
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –í–°–Æ –ª–æ–≥–∏–∫—É Telegram-–±–æ—Ç–∞:
   - –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è Facebook, —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤, –∫–∞—Ä—Ç–æ—á–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞, –≤—Å–µ –∫–Ω–æ–ø–∫–∏ –∏ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (–ò–∑–º–µ–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ, –ß–∞—Ç-–≥—Ä—É–ø–ø–∞, –õ–∏–¥—ã, –û—Ç—á—ë—Ç –ø–æ —Ä–µ–∫–ª–∞–º–µ, –≠–∫—Å–ø–æ—Ä—Ç, –ü–æ—Ä—Ç–∞–ª, –û–ø–ª–∞—Ç–∞, –ê–≤—Ç–æ-–æ—Ç—á—ë—Ç—ã, KPI, –£–¥–∞–ª–∏—Ç—å –∏ —Ç. –¥.).
   - –ö–æ–º–∞–Ω–¥—ã –≤–≤–æ–¥–∞ –¥–∞—Ç –¥–æ–ª–∂–Ω—ã –ø–∞—Ä—Å–∏—Ç—å –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –æ–∂–∏–¥–∞–µ–º–æ–º —Ñ–æ—Ä–º–∞—Ç–µ, –±–µ–∑ –æ—Ç–≤–µ—Ç–æ–≤ ¬´–ö–æ–º–∞–Ω–¥–∞ X –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è¬ª.
   - –ö–∞—Ä—Ç–æ—á–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞ –æ–±—è–∑–∞–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å ¬´–õ–∏–¥—ã: X (—Å–µ–≥–æ–¥–Ω—è) | Y (–≤—Å–µ–≥–æ)¬ª –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π CPA.
3. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –∞–≤—Ç–æ–æ—Ç—á—ë—Ç—ã: –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –æ—Ç—á—ë—Ç –≤ –∑–∞–¥–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–≥–æ –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã.
4. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø–æ—Ä—Ç–∞–ª: –ø—Ä–µ–ª–æ–∞–¥–µ—Ä, –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ API, –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ KPI, –ª–∏–¥–æ–≤, –∫–∞–º–ø–∞–Ω–∏–π, –æ–ø–ª–∞—Ç.
5. –†–∞–∑–±–∏—Ç—å —Ä–∞–±–æ—Ç—É –Ω–∞ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∏—Ç–µ—Ä–∞—Ü–∏–∏. –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –æ–±–Ω–æ–≤–ª—è—Ç—å README (—á—Ç–æ —Å–¥–µ–ª–∞–Ω–æ, —á—Ç–æ –¥–∞–ª—å—à–µ, –∫–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å) –∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤–∫–ª—é—á–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é ¬´–ö–∞–∫ –ø–æ–¥–∫–ª—é—á–∏—Ç—å Telegram webhook¬ª —Å URL `https://${WORKER_URL}/tg-webhook?secret=${TELEGRAM_SECRET}` –∏ –ø—Ä–∏–º–µ—Ä–æ–º `curl` –¥–ª—è `setWebhook`.
6. –ù–µ –ª–æ–º–∞—Ç—å —Ç–µ–∫—É—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî —Ç–æ–ª—å–∫–æ –¥–æ—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∏ –¥–æ–≤–æ–¥–∏—Ç—å –¥–æ —Ä–∞–±–æ—á–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è.

–ù–∞—á–Ω–∏ —Å –∞–Ω–∞–ª–∏–∑–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è, –æ–ø–∏—à–∏ –ø–ª–∞–Ω –∏—Ç–µ—Ä–∞—Ü–∏–π –≤ README, –∑–∞—Ç–µ–º —Ä–µ–∞–ª–∏–∑—É–π –≤—Å—ë –ø–æ —à–∞–≥–∞–º, –æ–ø–∏—Ä–∞—è—Å—å –Ω–∞ —ç—Ç–æ –¢–ó.
```

---

–î–æ–∫—É–º–µ–Ω—Ç –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ —Ä–∞–±–æ—á–µ–µ –¢–ó –¥–ª—è –∫–æ–º–∞–Ω–¥—ã –∏ –∫–∞–∫ master prompt –¥–ª—è Codex.
