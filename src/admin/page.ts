// This file is generated by scripts/embed-admin.mjs.
// Do not edit it manually ‚Äî edit the HTML/CSS/JS sources instead.
const html = "<!DOCTYPE html>\n<html lang=\"ru\">\n  <head>\n    <meta charset=\"UTF-8\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n    <title>TargetBot Admin</title>\n    <script src=\"https://cdn.tailwindcss.com?plugins=forms,typography\"></script>\n    <link rel=\"preconnect\" href=\"https://fonts.googleapis.com\" />\n    <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin />\n    <link\n      href=\"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap\"\n      rel=\"stylesheet\"\n    />\n    <style>\n      :root {\n  color-scheme: dark;\n  font-family: \"Inter\", system-ui, -apple-system, BlinkMacSystemFont, \"Segoe UI\", sans-serif;\n}\n\nbody {\n  background: #0f172a;\n}\n\n.btn-primary {\n  background: #16a34a;\n  color: #fff;\n  font-weight: 600;\n  padding: 0.5rem 1rem;\n  border-radius: 0.75rem;\n  transition: all 0.2s ease;\n}\n\n.btn-primary:hover {\n  background: #15803d;\n}\n\n.btn-secondary {\n  background: rgba(15, 23, 42, 0.7);\n  color: #e2e8f0;\n  font-weight: 600;\n  padding: 0.5rem 1rem;\n  border-radius: 0.75rem;\n  transition: all 0.2s ease;\n}\n\n.btn-secondary:hover {\n  background: rgba(30, 41, 59, 0.8);\n}\n\n.card {\n  background: rgba(15, 23, 42, 0.65);\n  backdrop-filter: blur(12px);\n  border-radius: 1.25rem;\n  padding: 1.5rem;\n  border: 1px solid rgba(71, 85, 105, 0.6);\n  box-shadow: 0 10px 40px rgba(15, 23, 42, 0.5);\n}\n\n.card-title {\n  font-size: 1.1rem;\n  font-weight: 600;\n  margin-bottom: 0.5rem;\n}\n\n.card-value {\n  font-size: 2rem;\n  font-weight: 700;\n  color: #34d399;\n}\n\n.card-subvalue {\n  margin-top: 0.25rem;\n  font-size: 0.95rem;\n  color: #cbd5f5;\n  opacity: 0.85;\n}\n\n.table {\n  width: 100%;\n  border-collapse: collapse;\n}\n\n.table th,\n.table td {\n  padding: 0.75rem 1rem;\n  text-align: left;\n  font-size: 0.95rem;\n  border-bottom: 1px solid rgba(71, 85, 105, 0.4);\n}\n\n.table tbody tr:nth-child(even) {\n  background: rgba(15, 23, 42, 0.4);\n}\n\n.badge {\n  display: inline-flex;\n  align-items: center;\n  padding: 0.25rem 0.75rem;\n  border-radius: 9999px;\n  background: rgba(52, 211, 153, 0.16);\n  color: #6ee7b7;\n  font-size: 0.75rem;\n  font-weight: 600;\n  text-transform: uppercase;\n}\n\n.tabs {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 0.5rem;\n  padding-bottom: 1.5rem;\n  margin-bottom: 1.5rem;\n  border-bottom: 1px solid rgba(71, 85, 105, 0.4);\n}\n\n.tab-button {\n  padding: 0.5rem 1rem;\n  border-radius: 0.75rem;\n  background: rgba(15, 23, 42, 0.6);\n  font-size: 0.9rem;\n  color: #cbd5f5;\n  transition: all 0.2s ease;\n}\n\n.tab-button:hover {\n  color: #fff;\n  background: rgba(148, 163, 184, 0.2);\n}\n\n.tab-button.active {\n  background: #16a34a;\n  color: #fff;\n  box-shadow: 0 10px 30px rgba(22, 163, 74, 0.35);\n}\n\n.tab-panel {\n  display: none;\n}\n\n.tab-panel.active {\n  display: block;\n}\n\n    </style>\n  </head>\n  <body class=\"bg-slate-950 text-slate-100 font-[Inter]\">\n    <div id=\"app\" class=\"min-h-screen\">\n      <main class=\"max-w-6xl mx-auto px-6 py-10 space-y-8\">\n        <header class=\"flex flex-col gap-2 md:flex-row md:items-center md:justify-between\">\n          <div>\n            <h1 class=\"text-3xl font-semibold\">TargetBot Admin Portal</h1>\n            <p class=\"text-slate-400\">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è–º–∏.</p>\n          </div>\n          <div class=\"flex items-center gap-3\">\n            <button id=\"refreshMeta\" class=\"btn-primary\">üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å Meta</button>\n            <button id=\"checkWebhook\" class=\"btn-secondary\">üì° –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Webhook</button>\n          </div>\n        </header>\n        <section>\n          <nav class=\"tabs\" role=\"tablist\">\n            <button class=\"tab-button active\" data-target=\"dashboard\">üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>\n            <button class=\"tab-button\" data-target=\"users\">üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</button>\n            <button class=\"tab-button\" data-target=\"leads\">üí¨ –ó–∞—è–≤–∫–∏</button>\n            <button class=\"tab-button\" data-target=\"integrations\">‚öôÔ∏è –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏</button>\n            <button class=\"tab-button\" data-target=\"settings\">üîí –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>\n          </nav>\n          <div class=\"tab-panels\">\n            <section id=\"dashboard\" class=\"tab-panel active\"></section>\n            <section id=\"users\" class=\"tab-panel\"></section>\n            <section id=\"leads\" class=\"tab-panel\"></section>\n            <section id=\"integrations\" class=\"tab-panel\"></section>\n            <section id=\"settings\" class=\"tab-panel\"></section>\n          </div>\n        </section>\n      </main>\n    </div>\n    <script type=\"module\">\n      const headers = () => {\n  const params = new URLSearchParams(window.location.search);\n  const key = params.get(\"key\");\n  const baseHeaders = { \"content-type\": \"application/json\" };\n  if (key) {\n    baseHeaders.Authorization = `Bearer ${key}`;\n    baseHeaders[\"X-Auth-Key\"] = key;\n  }\n  return baseHeaders;\n};\n\nasync function request(path, options = {}) {\n  const response = await fetch(path, {\n    ...options,\n    headers: {\n      ...headers(),\n      ...(options.headers ?? {}),\n    },\n  });\n  if (!response.ok) {\n    const text = await response.text();\n    throw new Error(`Request failed: ${response.status} ${text}`);\n  }\n  return response.json();\n}\n\nexport const api = {\n  async getLeads(filters = {}) {\n    const params = new URLSearchParams(window.location.search);\n    const key = params.get(\"key\") ?? \"\";\n    const query = new URLSearchParams();\n    if (key) query.set(\"key\", key);\n    if (filters.status && filters.status !== \"all\") {\n      query.set(\"status\", filters.status);\n    }\n    if (filters.source && filters.source !== \"all\") {\n      query.set(\"source\", filters.source);\n    }\n    if (filters.from) {\n      query.set(\"from\", filters.from);\n    }\n    if (filters.to) {\n      query.set(\"to\", filters.to);\n    }\n    const search = query.toString();\n    return request(`/api/leads${search ? `?${search}` : \"\"}`);\n  },\n  async getDashboard() {\n    const key = new URLSearchParams(window.location.search).get(\"key\") ?? \"\";\n    return request(`/api/dashboard?key=${key}`);\n  },\n  async getUsers() {\n    const key = new URLSearchParams(window.location.search).get(\"key\") ?? \"\";\n    return request(`/api/users?key=${key}`);\n  },\n  async getSettings() {\n    const key = new URLSearchParams(window.location.search).get(\"key\") ?? \"\";\n    return request(`/api/settings?key=${key}`);\n  },\n  async createApiKey({ label, role, owner } = {}) {\n    const key = new URLSearchParams(window.location.search).get(\"key\") ?? \"\";\n    return request(`/api/settings?key=${key}`, {\n      method: \"PUT\",\n      body: JSON.stringify({ action: \"create_key\", label, role, owner }),\n    });\n  },\n  async deleteApiKey(keyValue) {\n    const key = new URLSearchParams(window.location.search).get(\"key\") ?? \"\";\n    return request(`/api/settings?key=${key}`, {\n      method: \"PUT\",\n      body: JSON.stringify({ action: \"delete_key\", key: keyValue }),\n    });\n  },\n  async syncMeta() {\n    const key = new URLSearchParams(window.location.search).get(\"key\") ?? \"\";\n    return request(`/meta/sync?key=${key}`, {\n      method: \"POST\",\n      body: JSON.stringify({ ad_account_id: \"act_000000000000000\" }),\n    });\n  },\n  async checkWebhook() {\n    const key = new URLSearchParams(window.location.search).get(\"key\") ?? \"\";\n    return request(`/manage/telegram/webhook?key=${key}`);\n  },\n  async refreshWebhook() {\n    const key = new URLSearchParams(window.location.search).get(\"key\") ?? \"\";\n    return request(`/manage/telegram/webhook?key=${key}&action=refresh`, {\n      method: \"POST\",\n    });\n  },\n};\n\nwindow.TargetBotAdminAPI = api;\n\nconst api = window.TargetBotAdminAPI;\n\nconst dashboard = document.querySelector(\"#dashboard\");\nconst usersPanel = document.querySelector(\"#users\");\nconst leadsPanel = document.querySelector(\"#leads\");\nconst integrationsPanel = document.querySelector(\"#integrations\");\nconst settingsPanel = document.querySelector(\"#settings\");\nconst tabs = document.querySelectorAll(\".tab-button\");\nconst leadFilters = {\n  status: \"all\",\n  source: \"all\",\n  from: \"\",\n  to: \"\",\n};\n\nfunction humanize(value) {\n  return value\n    .toString()\n    .split(/[\\s_-]+/)\n    .map((part) => part.charAt(0).toUpperCase() + part.slice(1))\n    .join(\" \");\n}\n\nconst integerFormatter = new Intl.NumberFormat(\"ru-RU\", { maximumFractionDigits: 0 });\nconst decimalFormatter = new Intl.NumberFormat(\"ru-RU\", { minimumFractionDigits: 0, maximumFractionDigits: 2 });\n\nfunction formatInteger(value) {\n  return typeof value === \"number\" && Number.isFinite(value) ? integerFormatter.format(value) : \"‚Äî\";\n}\n\nfunction formatDecimal(value) {\n  return typeof value === \"number\" && Number.isFinite(value) ? decimalFormatter.format(value) : \"‚Äî\";\n}\n\nfunction formatPercentage(value) {\n  return typeof value === \"number\" && Number.isFinite(value) ? `${(value * 100).toFixed(1)}%` : \"‚Äî\";\n}\n\nfunction activateTab(targetId) {\n  document.querySelectorAll(\".tab-panel\").forEach((panel) => {\n    panel.classList.toggle(\"active\", panel.id === targetId);\n  });\n  tabs.forEach((tab) => {\n    tab.classList.toggle(\"active\", tab.dataset.target === targetId);\n  });\n}\n\ntabs.forEach((tab) => {\n  tab.addEventListener(\"click\", () => activateTab(tab.dataset.target));\n});\n\nasync function renderDashboard() {\n  dashboard.innerHTML = `<div class=\"space-y-4\">\n    <div class=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\n      <article class=\"card\">\n        <h2 class=\"card-title\">–õ–∏–¥—ã</h2>\n        <p class=\"card-value\" id=\"leads-today\">‚Äî</p>\n        <p class=\"card-subvalue\" id=\"leads-yesterday\">–í—á–µ—Ä–∞: ‚Äî</p>\n      </article>\n      <article class=\"card\">\n        <h2 class=\"card-title\">Spend Meta</h2>\n        <p class=\"card-value\" id=\"meta-spend\">‚Äî</p>\n        <p class=\"card-subvalue\" id=\"meta-ctr\">CTR: ‚Äî</p>\n      </article>\n      <article class=\"card\">\n        <h2 class=\"card-title\">–°—Ä–µ–¥–Ω–∏–π CPL</h2>\n        <p class=\"card-value\" id=\"meta-cpl\">‚Äî</p>\n        <p class=\"card-subvalue\" id=\"meta-leads\">–õ–∏–¥—ã: ‚Äî</p>\n      </article>\n      <article class=\"card\">\n        <h2 class=\"card-title\">Webhook</h2>\n        <p class=\"card-value\" id=\"telegram-webhook\">‚Äî</p>\n        <p class=\"card-subvalue\" id=\"telegram-webhook-note\"></p>\n      </article>\n    </div>\n    <p class=\"text-xs text-slate-500\" id=\"dashboard-updated\">–û–±–Ω–æ–≤–ª–µ–Ω–æ: ‚Äî</p>\n  </div>`;\n\n  const data = await api.getDashboard();\n  const snapshot = data.snapshot ?? data;\n  const leads = snapshot.leads ?? {};\n  const metaTotals = snapshot.meta?.totals ?? {};\n  const webhook = snapshot.telegramWebhook ?? {};\n\n  document.querySelector(\"#leads-today\").textContent = formatInteger(leads.today);\n  document.querySelector(\"#leads-yesterday\").textContent = `–í—á–µ—Ä–∞: ${formatInteger(leads.yesterday)}`;\n  document.querySelector(\"#meta-spend\").textContent = formatDecimal(metaTotals.spend);\n  document.querySelector(\"#meta-cpl\").textContent = formatDecimal(metaTotals.cpl ?? undefined);\n  document.querySelector(\"#meta-ctr\").textContent = `CTR: ${formatPercentage(metaTotals.ctr ?? undefined)}`;\n  document.querySelector(\"#meta-leads\").textContent = `–õ–∏–¥—ã: ${formatInteger(metaTotals.leads)}`;\n\n  const webhookStatus = webhook.configured\n    ? webhook.url\n      ? \"–ê–∫—Ç–∏–≤–µ–Ω\"\n      : \"–û–∂–∏–¥–∞–µ—Ç URL\"\n    : \"–ù–µ –ø–æ–¥–∫–ª—é—á—ë–Ω\";\n  document.querySelector(\"#telegram-webhook\").textContent = webhookStatus;\n\n  const webhookNotes = [];\n  if (webhook.url) webhookNotes.push(webhook.url);\n  if (typeof webhook.pendingUpdateCount === \"number\") {\n    webhookNotes.push(`–û—á–µ—Ä–µ–¥—å: ${formatInteger(webhook.pendingUpdateCount)}`);\n  }\n  if (webhook.lastErrorMessage) webhookNotes.push(`–û—à–∏–±–∫–∞: ${webhook.lastErrorMessage}`);\n  if (webhook.error && !webhook.lastErrorMessage) webhookNotes.push(webhook.error);\n  document.querySelector(\"#telegram-webhook-note\").textContent = webhookNotes.join(\" ¬∑ \") || \"–ë–µ–∑ –æ—à–∏–±–æ–∫\";\n\n  const updatedAt = snapshot.generatedAt ? new Date(snapshot.generatedAt).toLocaleString() : \"‚Äî\";\n  const metaUpdated = snapshot.meta?.updatedAt ? new Date(snapshot.meta.updatedAt).toLocaleString() : \"‚Äî\";\n  document.querySelector(\"#dashboard-updated\").textContent = `–û–±–Ω–æ–≤–ª–µ–Ω–æ: ${updatedAt} ¬∑ Meta: ${metaUpdated}`;\n}\n\nasync function renderUsers() {\n  const data = await api.getUsers();\n  usersPanel.innerHTML = `<div class=\"overflow-x-auto\">\n    <table class=\"table\">\n      <thead><tr><th>ID</th><th>–ò–º—è</th><th>Username</th><th>–†–æ–ª—å</th></tr></thead>\n      <tbody>\n        ${data.users\n          .map(\n            (user) => `<tr>\n              <td>${user.id}</td>\n              <td>${user.firstName ?? \"‚Äî\"} ${user.lastName ?? \"\"}</td>\n              <td>${user.username ? \"@\" + user.username : \"‚Äî\"}</td>\n              <td><span class=\"badge\">${user.role}</span></td>\n            </tr>`,\n          )\n          .join(\"\")}\n      </tbody>\n    </table>\n  </div>`;\n}\n\nasync function renderLeads() {\n  const data = await api.getLeads(leadFilters);\n  const statuses = data.available?.statuses ?? [\"new\", \"in_progress\", \"closed\"];\n  const sources = data.available?.sources ?? [\"telegram\", \"facebook\", \"manual\"];\n\n  leadsPanel.innerHTML = `<div class=\"space-y-4\">\n    <section class=\"card space-y-4\">\n      <div class=\"flex items-center justify-between\">\n        <h2 class=\"card-title\">–§–∏–ª—å—Ç—Ä—ã</h2>\n        <button type=\"button\" class=\"btn-secondary\" id=\"lead-filters-reset\">–°–±—Ä–æ—Å–∏—Ç—å</button>\n      </div>\n      <div class=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\n        <label class=\"flex flex-col gap-2 text-sm text-slate-300\">\n          <span>–°—Ç–∞—Ç—É—Å</span>\n          <select id=\"lead-status-filter\" class=\"rounded-lg border border-slate-600 bg-slate-900/60 px-3 py-2 text-slate-100\">\n            <option value=\"all\">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>\n            ${statuses\n              .map((status) => `<option value=\"${status}\">${humanize(status)}</option>`)\n              .join(\"\")}\n          </select>\n        </label>\n        <label class=\"flex flex-col gap-2 text-sm text-slate-300\">\n          <span>–ò—Å—Ç–æ—á–Ω–∏–∫</span>\n          <select id=\"lead-source-filter\" class=\"rounded-lg border border-slate-600 bg-slate-900/60 px-3 py-2 text-slate-100\">\n            <option value=\"all\">–í—Å–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏</option>\n            ${sources\n              .map((source) => `<option value=\"${source}\">${humanize(source)}</option>`)\n              .join(\"\")}\n          </select>\n        </label>\n        <label class=\"flex flex-col gap-2 text-sm text-slate-300\">\n          <span>–° –¥–∞—Ç—ã</span>\n          <input type=\"date\" id=\"lead-from-filter\" class=\"rounded-lg border border-slate-600 bg-slate-900/60 px-3 py-2 text-slate-100\" />\n        </label>\n        <label class=\"flex flex-col gap-2 text-sm text-slate-300\">\n          <span>–ü–æ –¥–∞—Ç—É</span>\n          <input type=\"date\" id=\"lead-to-filter\" class=\"rounded-lg border border-slate-600 bg-slate-900/60 px-3 py-2 text-slate-100\" />\n        </label>\n      </div>\n    </section>\n    <div class=\"overflow-x-auto\">\n      <table class=\"table\">\n        <thead><tr><th>ID</th><th>–ò–º—è</th><th>–ö–æ–Ω—Ç–∞–∫—Ç</th><th>–ò—Å—Ç–æ—á–Ω–∏–∫</th><th>–°—Ç–∞—Ç—É—Å</th><th>–°–æ–∑–¥–∞–Ω</th><th>–û–±–Ω–æ–≤–ª–µ–Ω–æ</th></tr></thead>\n        <tbody>\n          ${data.leads\n            .map(\n              (lead) => `<tr>\n                <td>${lead.id}</td>\n                <td>${lead.name}</td>\n                <td>${lead.contact}</td>\n                <td>${lead.source ? humanize(lead.source) : \"‚Äî\"}</td>\n                <td><span class=\"badge\">${humanize(lead.status)}</span></td>\n                <td>${new Date(lead.createdAt).toLocaleString()}</td>\n                <td>${new Date(lead.updatedAt).toLocaleString()}</td>\n              </tr>`,\n            )\n            .join(\"\") || `<tr><td colspan=\"7\" class=\"text-center text-slate-400\">–ó–∞—è–≤–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</td></tr>`}\n        </tbody>\n      </table>\n    </div>\n  </div>`;\n\n  const statusSelect = leadsPanel.querySelector(\"#lead-status-filter\");\n  const sourceSelect = leadsPanel.querySelector(\"#lead-source-filter\");\n  const fromInput = leadsPanel.querySelector(\"#lead-from-filter\");\n  const toInput = leadsPanel.querySelector(\"#lead-to-filter\");\n  const resetButton = leadsPanel.querySelector(\"#lead-filters-reset\");\n\n  if (statusSelect) statusSelect.value = leadFilters.status;\n  if (sourceSelect) sourceSelect.value = leadFilters.source;\n  if (fromInput) fromInput.value = leadFilters.from;\n  if (toInput) toInput.value = leadFilters.to;\n\n  statusSelect?.addEventListener(\"change\", async (event) => {\n    leadFilters.status = event.target.value;\n    await renderLeads();\n  });\n\n  sourceSelect?.addEventListener(\"change\", async (event) => {\n    leadFilters.source = event.target.value;\n    await renderLeads();\n  });\n\n  fromInput?.addEventListener(\"change\", async (event) => {\n    leadFilters.from = event.target.value;\n    await renderLeads();\n  });\n\n  toInput?.addEventListener(\"change\", async (event) => {\n    leadFilters.to = event.target.value;\n    await renderLeads();\n  });\n\n  resetButton?.addEventListener(\"click\", async () => {\n    leadFilters.status = \"all\";\n    leadFilters.source = \"all\";\n    leadFilters.from = \"\";\n    leadFilters.to = \"\";\n    await renderLeads();\n  });\n}\n\nasync function renderIntegrations() {\n  integrationsPanel.innerHTML = `<div class=\"space-y-4\">\n    <section class=\"card\">\n      <h2 class=\"card-title\">Facebook Meta</h2>\n      <p class=\"text-sm text-slate-400\">OAuth –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–∞–º–ø–∞–Ω–∏–π.</p>\n      <a class=\"btn-primary inline-flex items-center\" href=\"/auth/facebook\">üîó –ü–æ–¥–∫–ª—é—á–∏—Ç—å Meta</a>\n    </section>\n    <section class=\"card\">\n      <h2 class=\"card-title\">Telegram Webhook</h2>\n      <p class=\"text-sm text-slate-400\">–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ–±—Ö—É–∫–∞ Telegram.</p>\n      <button class=\"btn-secondary\" id=\"refreshWebhook\">üîÅ –û–±–Ω–æ–≤–∏—Ç—å</button>\n    </section>\n  </div>`;\n  document.querySelector(\"#refreshWebhook\").addEventListener(\"click\", async () => {\n    await api.refreshWebhook();\n    alert(\"–í–µ–±—Ö—É–∫ –æ–±–Ω–æ–≤–ª—ë–Ω\");\n  });\n}\n\nasync function renderSettings() {\n  const settings = await api.getSettings();\n  const keys = settings.apiKeys ?? [];\n  settingsPanel.innerHTML = `<div class=\"grid gap-4\">\n    <article class=\"card\">\n      <h2 class=\"card-title\">–û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h2>\n      <dl class=\"grid gap-2 text-sm text-slate-300\">\n        <div class=\"flex justify-between\"><dt>Worker URL</dt><dd>${settings.workerUrl ?? \"‚Äî\"}</dd></div>\n        <div class=\"flex justify-between\"><dt>Telegram Token</dt><dd>${settings.telegramTokenConfigured ? \"—Å–∫—Ä—ã—Ç\" : \"‚Äî\"}</dd></div>\n        <div class=\"flex justify-between\"><dt>Facebook App</dt><dd>${settings.facebookAppId ?? \"‚Äî\"}</dd></div>\n      </dl>\n    </article>\n    <article class=\"card space-y-4\">\n      <div class=\"flex items-center justify-between\">\n        <h2 class=\"card-title\">API –∫–ª—é—á–∏</h2>\n        <button class=\"btn-primary\" id=\"createApiKey\">‚ûï –°–æ–∑–¥–∞—Ç—å</button>\n      </div>\n      <p class=\"text-sm text-slate-400\">–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–ª—é—á–∏ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤ –∏ —Å–µ—Ä–≤–∏—Å–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–≥–æ–ª–æ–≤–æ–∫ <code>X-Auth-Key</code>.</p>\n      <div class=\"overflow-x-auto\">\n        <table class=\"table\">\n          <thead><tr><th>–ö–ª—é—á</th><th>–ú–µ—Ç–∫–∞</th><th>–†–æ–ª—å</th><th>–°–æ–∑–¥–∞–Ω</th><th>–ü–æ—Å–ª–µ–¥–Ω–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</th><th></th></tr></thead>\n          <tbody>\n            ${keys\n              .map(\n                (key) => `<tr>\n                  <td class=\"font-mono text-xs\">${key.key}</td>\n                  <td>${key.label ?? \"‚Äî\"}</td>\n                  <td><span class=\"badge\">${key.role}</span></td>\n                  <td>${new Date(key.createdAt).toLocaleString()}</td>\n                  <td>${key.lastUsedAt ? new Date(key.lastUsedAt).toLocaleString() : \"‚Äî\"}</td>\n                  <td class=\"text-right\"><button class=\"btn-secondary delete-api-key\" data-key=\"${key.key}\">–£–¥–∞–ª–∏—Ç—å</button></td>\n                </tr>`,\n              )\n              .join(\"\") || `<tr><td colspan=\"6\" class=\"text-center text-slate-400\">–ö–ª—é—á–∏ –µ—â—ë –Ω–µ —Å–æ–∑–¥–∞–Ω—ã</td></tr>`}\n          </tbody>\n        </table>\n      </div>\n    </article>\n  </div>`;\n\n  document.querySelector(\"#createApiKey\").addEventListener(\"click\", async () => {\n    const label = prompt(\"–ù–∞–∑–≤–∞–Ω–∏–µ –∫–ª—é—á–∞\", \"–ü–∞—Ä—Ç–Ω—ë—Ä\");\n    if (label === null) return;\n    const role = prompt(\"–†–æ–ª—å –¥–ª—è –∫–ª—é—á–∞ (admin/manager/partner/service)\", \"partner\");\n    if (role === null) return;\n    const owner = prompt(\"–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤–ª–∞–¥–µ–ª—å—Ü–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)\") || undefined;\n    const response = await api.createApiKey({ label, role: role.trim().toLowerCase(), owner });\n    alert(`–°–æ–∑–¥–∞–Ω –∫–ª—é—á: ${response.key.key}`);\n    await renderSettings();\n  });\n\n  document.querySelectorAll(\".delete-api-key\").forEach((button) => {\n    button.addEventListener(\"click\", async () => {\n      const keyValue = button.dataset.key;\n      if (!keyValue) return;\n      if (!confirm(\"–£–¥–∞–ª–∏—Ç—å –∫–ª—é—á?\")) return;\n      await api.deleteApiKey(keyValue);\n      await renderSettings();\n    });\n  });\n}\n\nasync function bootstrap() {\n  await renderDashboard();\n  await renderUsers();\n  await renderLeads();\n  await renderIntegrations();\n  await renderSettings();\n}\n\ndocument.querySelector(\"#refreshMeta\").addEventListener(\"click\", async () => {\n  await api.syncMeta();\n  await renderDashboard();\n  alert(\"–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è Meta –≤—ã–ø–æ–ª–Ω–µ–Ω–∞\");\n});\n\ndocument.querySelector(\"#checkWebhook\").addEventListener(\"click\", async () => {\n  const status = await api.checkWebhook();\n  alert(`Webhook: ${status.status}`);\n});\n\nbootstrap().catch((error) => {\n  console.error(error);\n  dashboard.innerHTML = `<div class=\"card\">–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ: ${error.message}</div>`;\n});\n\n    </script>\n  </body>\n</html>\n";

export function renderAdminPage() {
  return new Response(html, {
    headers: {
      "content-type": "text/html; charset=utf-8",
      "cache-control": "no-store",
    },
  });
}
