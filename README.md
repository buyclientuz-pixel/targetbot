# Targetbot ‚Äî —ç—Ç–∞–ø 1: –±–∞–∑–æ–≤—ã–π –∫–∞—Ä–∫–∞—Å –≤–æ—Ä–∫–µ—Ä–∞

–ü—Ä–æ–µ–∫—Ç ¬´CI ‚Üí GitHub ‚Üí Cloudflare Workers ‚Üí Telegram-–±–æ—Ç –æ—Ç—á—ë—Ç–æ–≤ –ø–æ —Ä–µ–∫–ª–∞–º–µ Meta¬ª –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω —Å —á–∏—Å—Ç–æ–≥–æ –ª–∏—Å—Ç–∞.
–ù–∞ –ø–µ—Ä–≤–æ–º —ç—Ç–∞–ø–µ –º—ã —Å–æ–±–∏—Ä–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω–æ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω—ã–π –∫–∞—Ä–∫–∞—Å, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–≤—è–∑–∫—É Git ‚Üí Cloudflare ‚Üí Telegram
–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ø–æ—á–≤—É –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –º–æ–¥—É–ª–µ–π (OAuth Meta, –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å, –æ—Ç—á—ë—Ç—ã, –∞–ª–µ—Ä—Ç—ã, –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –ø–æ—Ä—Ç–∞–ª).

## –ß—Ç–æ —É–∂–µ –≥–æ—Ç–æ–≤–æ
- **HTTP-–º–∞—Ä—à—Ä—É—Ç—ã –∏ Meta OAuth:** –≤–æ—Ä–∫–µ—Ä –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç `GET /`, `GET /health`, `POST /tg`, –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –ø–æ—Ä—Ç–∞–ª `/p/{code}`, –∞ —Ç–∞–∫–∂–µ
  –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ Meta (`/fb_auth`, `/fb_cb`, `/fb_debug`). –ü–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ OAuth long-lived —Ç–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ KV,
  –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫—ç—à Meta –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º/–≤ –ø—Ä–æ–µ–∫—Ç–Ω—ã–π —á–∞—Ç.
- **–ü–∞—Ä—Å–∏–Ω–≥ –æ–∫—Ä—É–∂–µ–Ω–∏—è:** —Ç–æ–∫–µ–Ω Telegram –∏—â–µ—Ç—Å—è –≤ –∞–ª–∏–∞—Å–∞—Ö (`BOT_TOKEN`, `TG_API_TOKEN`, `TELEGRAM_BOT_TOKEN` –∏ —Ç.–¥.), —Å–ø–∏—Å–æ–∫
  –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –±–µ—Ä—ë—Ç—Å—è –∏–∑ `ADMIN_IDS` –∏–ª–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `7623982602, 573424022`.
- **–•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö (R2 + KV):** –æ—Ç—á—ë—Ç—ã, –∫–∞—Ä—Ç–æ—á–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤ –∏ –∫—ç—à–∏ Meta –ª–µ–∂–∞—Ç –≤ R2 (`reports/{project_id}.json`, `data/DB/...`),
  –∑–∞–ø–∏—Å–∏ –ø–æ–º–µ—á–∞—é—Ç—Å—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ —Å `updated_at` –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ –≤–æ–∑—Ä–∞—Å—Ç–µ —Å—Ç–∞—Ä—à–µ 30 –º–∏–Ω—É—Ç. KV –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ
  –¥–ª—è —Å–µ—Å—Å–∏–π (`session:/admin:session:`) –∏ —Ç–æ–∫–µ–Ω–∞ Meta (`meta:auth`), –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏–º–µ—é—Ç fallback `_fallback=true`, –∞ –æ—à–∏–±–∫–∏ –≤–æ—Ä–∫–µ—Ä–∞
  —Å–∫–ª–∞–¥—ã–≤–∞—é—Ç—Å—è –≤ R2 (`logs/{date}.json`).
- **–û–±—Ä–∞–±–æ—Ç—á–∏–∫ Telegram:** –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –∫–æ–º–∞–Ω–¥—ã `/start`, `/help`, `/register`, `/admin`, `/pingtest`, `/cancel`. –ö–æ–º–∞–Ω–¥–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä
  —Ä–∞—Å—à–∏—Ä—è–µ–º, —Ç–µ–ø–µ—Ä—å –≤ –Ω—ë–º –∂–∏–≤—É—Ç —Ñ–æ—Ä–º—ã —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è KPI, —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–æ–≤ –∏ OAuth.
- **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å:** –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Facebook/Meta, –Ω–∞–∑–≤–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞, –ø–µ—Ä–µ—á–µ–Ω—å —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∫–∞–±–∏–Ω–µ—Ç–æ–≤ —Å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏
  –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–µ–π, –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –∏ CPA –ø–æ –∞–∫—Ç–∏–≤–Ω—ã–º –∫–∞–º–ø–∞–Ω–∏—è–º, –∞ —Ç–∞–∫–∂–µ —Å—Ç–∞—Ç—É—Å —Ç–µ–ª–µ–≥—Ä–∞–º-–≤–µ–±—Ö—É–∫–∞. –ì–ª–∞–≤–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –º–µ—Å—Ç–µ –±–µ–∑
  –ø–æ—Ç–æ–∫–∞ –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –∫–ª—é—á–µ–≤—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (¬´–ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è¬ª, ¬´‚ûï –ü–æ–¥–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–µ–∫—Ç¬ª, ¬´üìÅ –ü—Ä–æ–µ–∫—Ç—ã¬ª, ¬´üÜï –ù–æ–≤—ã–µ –†–ö¬ª,
  ¬´üîÑ –û–±–Ω–æ–≤–∏—Ç—å—Å—è¬ª, ¬´üîÅ –í–µ–±—Ö—É–∫¬ª).
- **Meta —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** `GET /manage/meta` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å–≤–æ–¥–∫—É, –ø–∞—Ä–∞–º–µ—Ç—Ä `refresh=1` —Ñ–æ—Ä—Å–∏—Ä—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ, –∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ Cloudflare
  –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ.
- **–ú–∞—Å—Ç–µ—Ä –ø—Ä–æ–µ–∫—Ç–æ–≤:** –∏–∑ –∞–¥–º–∏–Ω–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥ `admin:project:connect`, –∫–æ—Ç–æ—Ä—ã–π –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –≤–≤–æ–¥, –ø–æ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ
  —Ä–µ–∫–ª–∞–º–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã, –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç KPI –∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, —Ä–∞—Å—Å—ã–ª–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º –∏ –≤ —á–∞—Ç –ø—Ä–æ–µ–∫—Ç–∞.
- **–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∏ –ø—Ä–µ—Å–µ—Ç—ã:** –º–∞—Å—Ç–µ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —É—á–∏—Ç—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–æ –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç, –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç
  –ø—Ä–µ—Å–µ—Ç—ã —á–∞—Ç–æ–≤ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–æ–µ–∫—Ç—ã –±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø–∏—Å–µ–π.
- **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫–∏:** –º–∞—Å—Ç–µ—Ä —Å—Ä–∞–∑—É –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã–µ —Ä–µ–∫–ª–∞–º–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã Meta –∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —á–∞—Ç—ã (—á–µ—Ä–µ–∑ `/register`),
  –≤—ã–±–æ—Ä –¥–µ–ª–∞–µ—Ç—Å—è –æ–¥–Ω–æ–π –∫–Ω–æ–ø–∫–æ–π –±–µ–∑ —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞ ID.
- **–£–ø—Ä–æ—â—ë–Ω–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:** –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –Ω–∞–∂–∞—Ç—å ¬´‚úÖ –ì–æ—Ç–æ–≤–æ¬ª ‚Äî –±–æ—Ç —Å–∞–º –ø–æ–¥—Å—Ç–∞–≤–∏—Ç –∫–æ–¥ –ø—Ä–æ–µ–∫—Ç–∞, KPI –∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é,
  –∞ –ø—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–µ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –∫–Ω–æ–ø–∫—É ¬´üîÅ –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–µ–∫—Ç¬ª –≤–º–µ—Å—Ç–æ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥.
- **OAuth –∏–∑ –∞–¥–º–∏–Ω–∫–∏:** –∫–Ω–æ–ø–∫–∞ ¬´–ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –≤ Facebook¬ª —Å—Ä–∞–∑—É —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É `/fb_auth?session=‚Ä¶`, –ø–æ—ç—Ç–æ–º—É –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ
  —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ —Å—Å—ã–ª–∫–æ–π –±–æ–ª—å—à–µ –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è; –ø–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –≤–æ—Ä–∫–µ—Ä –ø—Ä–∏—Å—ã–ª–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤ —á–∞—Ç –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º.
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ–±—Ö—É–∫–æ–º Telegram:** –≤–æ—Ä–∫–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç webhook –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø–∞–Ω–µ–ª–∏ –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –µ–≥–æ –∏–∑ –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫–∏.
- **–ö–∞—Ä—Ç–æ—á–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤:** –∏–∑ –ø–∞–Ω–µ–ª–∏ –º–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞ (—Ñ–∏–Ω–∞–Ω—Å—ã, –∫–∞–º–ø–∞–Ω–∏–∏, KPI), —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —ç–∫—Å–ø—Ä–µ—Å—Å-–æ—Ç—á—ë—Ç –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º –∏ –ø–æ–ª—É—á–∏—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ –æ–ø–ª–∞—Ç–∞–º; —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∏ –∞–ª–µ—Ä—Ç—ã –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã, —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.
- **–†–µ–¥–∞–∫—Ç–æ—Ä KPI –∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π:** –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Ü–µ–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞, –¥–Ω–µ–≤–Ω–æ–π –±—é–¥–∂–µ—Ç –∏ –≥—Ä–∞—Ñ–∏–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç—á—ë—Ç–æ–≤ —Ü–µ–ª–∏–∫–æ–º —á–µ—Ä–µ–∑ –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫–∏ (–±–µ–∑ —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞ `–∫–ª—é—á=–∑–Ω–∞—á–µ–Ω–∏–µ`), –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ KV –∏ —Å—Ä–∞–∑—É –æ—Ç—Ä–∞–∂–∞—é—Ç—Å—è –≤ –∫–∞—Ä—Ç–æ—á–∫–µ –ø—Ä–æ–µ–∫—Ç–∞.
- **–ê–≤—Ç–æ–æ—Ç—á—ë—Ç—ã –∏ –ø—Ä–µ—Å–µ—Ç—ã:** –∫–Ω–æ–ø–∫–∏ ¬´–°–µ–≥–æ–¥–Ω—è/–í—á–µ—Ä–∞/7 –¥–Ω–µ–π/–ú–µ—Å—è—Ü¬ª —Ñ–æ—Ä–º–∏—Ä—É—é—Ç –∂–∏–≤—ã–µ –≤—ã–≥—Ä—É–∑–∫–∏ Meta, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã, –∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ Cloudflare —Ä–∞—Å—Å—ã–ª–∞–µ—Ç –æ—Ç—á—ë—Ç—ã –≤ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π —á–∞—Ç –∏ –õ–° –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é.
- **–§–æ—Ä–º–∞—Ç –æ—Ç—á—ë—Ç–æ–≤:** –∑–∞–≥–æ–ª–æ–≤–æ–∫ `üìÜ –û—Ç—á—ë—Ç ‚Ä¶` –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –∏ –¥–∞—Ç—É, –∫–∞–∂–¥–∞—è –∫–∞–º–ø–∞–Ω–∏—è –≤—ã–≤–æ–¥–∏—Ç—Å—è –≤ –¥–≤–∞ –∫–æ–º–ø–∞–∫—Ç–Ω—ã—Ö –∞–±–∑–∞—Ü–∞: –ø–µ—Ä–≤—ã–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞—Å—Ö–æ–¥, –≤—Ç–æ—Ä–æ–π ‚Äî –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ –ø–æ —Ü–µ–ª–∏ (–ª–∏–¥—ã, –∫–æ–Ω–≤–µ—Ä—Å–∏–∏, –∫–ª–∏–∫–∏, –æ—Ö–≤–∞—Ç) —Å –∞–∫—Ç—É–∞–ª—å–Ω–æ–π CPL/CPA/CPC/CPM –∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏. –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞ `üßæ` –∏ –∫–Ω–æ–ø–∫–∞ ¬´–ü–æ—Ä—Ç–∞–ª¬ª —É–ø—Ä–æ—â–∞—é—Ç –æ—Ç–ø—Ä–∞–≤–∫—É —Ü–∏—Ñ—Ä –∫–ª–∏–µ–Ω—Ç—É –∏ –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –≤–∏—Ç—Ä–∏–Ω—É.
- **–°–≤–æ–¥–Ω—ã–π –æ—Ç—á—ë—Ç:** –∫–Ω–æ–ø–∫–∞ ¬´üìà –°–≤–æ–¥–Ω—ã–π –æ—Ç—á—ë—Ç¬ª —Å—Ç—Ä–æ–∏—Ç –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç—á—ë—Ç (7 –¥–Ω–µ–π + –≤—á–µ—Ä–∞ + —Å–µ–≥–æ–¥–Ω—è), —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∏ –¥–∞—ë—Ç –±—ã—Å—Ç—Ä—ã–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ —á–∞—Ç –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø–æ—Ä—Ç–∞–ª–∞ –±–µ–∑ –ª–∏—à–Ω–∏—Ö –≤–ª–æ–∂–µ–Ω–∏–π.
- **–ê–ª–µ—Ä—Ç—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:** –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –Ω—É–ª–µ–≤–æ–π —Ä–∞—Å—Ö–æ–¥, –ø–ª–∞—Ç—ë–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã, –∞–Ω–æ–º–∞–ª–∏–∏ –∫–∞–º–ø–∞–Ω–∏–π, —É—Å—Ç–∞–ª–æ—Å—Ç—å –∫—Ä–µ–∞—Ç–∏–≤–æ–≤ –∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ KPI, –∞ –±–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å –ø–æ–¥—Å–∫–∞–∑–∫–∞–º–∏ –ø–æ –¥–∞–ª—å–Ω–µ–π—à–∏–º –¥–µ–π—Å—Ç–≤–∏—è–º.
- **–ê–≤—Ç–æ–ø–∞—É–∑–∞ –∫–∞–º–ø–∞–Ω–∏–π:** —Ä–∞–∑–¥–µ–ª ¬´‚è∏ –ü–∞—É–∑–∞ –æ—Ç—á—ë—Ç–æ–≤¬ª –ø—Ä–µ–≤—Ä–∞—Ç–∏–ª—Å—è –≤ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É ‚Äî –º–æ–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–ø–∞—É–∑—É, –≤—ã–±—Ä–∞—Ç—å –ø–æ—Ä–æ–≥ –¥–Ω–µ–π, –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∏ –≤—Ä—É—á–Ω—É—é –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–∞–º–ø–∞–Ω–∏–∏; –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ç–∞–≤–∏—Ç –∫–∞–º–ø–∞–Ω–∏–∏ –Ω–∞ –ø–∞—É–∑—É –ø—Ä–∏ –º–Ω–æ–≥–æ–¥–Ω–µ–≤–Ω–æ–º –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ KPI.
- **–ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π –ø–æ—Ä—Ç–∞–ª:** –∑–∞—â–∏—â—ë–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞ `/p/{code}?sig=...` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∞–≥—Ä–µ–≥–∞—Ç—ã ¬´–°–µ–≥–æ–¥–Ω—è/–í—á–µ—Ä–∞/7 –¥–Ω–µ–π/–ú–¢–î/–ì–æ–¥¬ª, –¥–∞—Ç—É —Å–ª–µ–¥—É—é—â–µ–π –æ–ø–ª–∞—Ç—ã, —Ç–æ–ø-–∫–∞–º–ø–∞–Ω–∏–∏,
  —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –≤–∫–ª–∞–¥–∫–∏ –∏ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ API `/api/meta/status` –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏, –∞ —Ñ–æ—Ä–º–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ ¬´–ù–∞–ø–∏—Å–∞—Ç—å –≤ —á–∞—Ç¬ª –¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –≤ Telegram.
- **UI –ø–æ—Ä—Ç–∞–ª–∞:** –∫–∞—Ä—Ç–æ—á–∫–∞ ¬´–°–ª–µ–¥—É—é—â–∞—è –æ–ø–ª–∞—Ç–∞¬ª –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –¥–∞—Ç—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É, –∫–∞–º–ø–∞–Ω–∏–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –∫–æ–º–ø–∞–∫—Ç–Ω—ã–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏ —Å —Ü–≤–µ—Ç–Ω—ã–º–∏ —Å—Ç–∞—Ç—É—Å–∞–º–∏,
  –¥–æ—Å—Ç—É–ø–Ω—ã –≤–∫–ª–∞–¥–∫–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤ (–∞–∫—Ç–∏–≤–Ω—ã–µ/–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ/–≤—Å–µ), —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Ä–∞—Å—Ö–æ–¥—É/–ª–∏–¥–∞–º/CPA –∏ –∫–Ω–æ–ø–∫–∞ ¬´–ù–∞–ø–∏—Å–∞—Ç—å –≤ —á–∞—Ç¬ª, –≤–µ–¥—É—â–∞—è –≤ –ø—Ä–æ–µ–∫—Ç–Ω—ã–π —Ç–æ–ø–∏–∫.
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç–∞–ª–∞–º–∏ –∏ –æ–ø–ª–∞—Ç–æ–π:** –≤ –∫–∞—Ä—Ç–æ—á–∫–µ –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ—è–≤–∏–ª–∏—Å—å –±—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è ¬´–ß–∞—Ç-–ì—Ä—É–ø–ø–∞ | –ü–æ—Ä—Ç–∞–ª | –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ | –û–ø–ª–∞—Ç–∞ | –ü–∞—É–∑–∞ –æ—Ç—á—ë—Ç–æ–≤ | –¢–∏—Ö–∏–π —Ä–µ–∂–∏–º¬ª.
  –ü–æ—Ä—Ç–∞–ª —Å–æ–∑–¥–∞—ë—Ç—Å—è –∏–ª–∏ –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è –æ–¥–Ω–æ–π –∫–Ω–æ–ø–∫–æ–π, —Å—Å—ã–ª–∫–∞ –Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç –∏—Å—Ö–æ–¥–Ω—ã–π —Ç–æ–∫–µ–Ω, –∞ –ø—Ä–∏ –æ—Ç–º–µ—Ç–∫–µ ¬´–û—Ç–∫–∞–∑–∞–ª—Å—è –æ–ø–ª–∞—á–∏–≤–∞—Ç—å¬ª –¥–æ—Å—Ç—É–ø –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è.
  –†–∞–∑–¥–µ–ª ¬´–û–ø–ª–∞—Ç–∞¬ª –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –±—ã—Å—Ç—Ä—ã–µ –∫–Ω–æ–ø–∫–∏ (¬´–û–ø–ª–∞—Ç–∏–ª —Å–µ–≥–æ–¥–Ω—è/–≤—á–µ—Ä–∞¬ª, –≤—ã–±–æ—Ä –¥–∞—Ç—ã, –ø–æ–º–µ—Ç–∫–∞ –æ—Ç–∫–∞–∑–∞) –∏ –ø—Ä–∏–≤—è–∑–∫—É –∫ –∫–∞–ª–µ–Ω–¥–∞—Ä—é –±–µ–∑ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥.
- **–ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ –ø–æ—Ä—Ç–∞–ª—É:** –æ—Å–Ω–æ–≤–Ω–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –≤—ã–≤–æ–¥–∏—Ç –∫–Ω–æ–ø–∫—É ¬´üåê –ü–æ—Ä—Ç–∞–ª¬ª —Å—Ä–∞–∑—É —Å —Ä–∞–±–æ—á–µ–π —Å—Å—ã–ª–∫–æ–π, –∞ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ä—è–¥ ¬´‚öôÔ∏è –ü–æ—Ä—Ç–∞–ª¬ª –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (—Å–æ–∑–¥–∞–Ω–∏–µ, –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è, –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ).
- **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤ –ø–æ—Ä—Ç–∞–ª–∞:** –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∏–ª–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –≤–∫–ª—é—á–µ–Ω–∏–∏ –ø–æ—Ä—Ç–∞–ª —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏ —Å–∞–º —Ç–æ–∫–µ–Ω, –∏ –≤—ã—á–∏—Å–ª–µ–Ω–Ω—É—é –ø–æ–¥–ø–∏—Å—å (`portal.signature`, `tokens.portal_signature`) –≤ KV.
  –ó–∞ —Å—á—ë—Ç —ç—Ç–æ–≥–æ —Å—Å—ã–ª–∫–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —Ä–∞–±–æ—á–∏–º–∏ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, –∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–µ–π –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –¥–∞–∂–µ –ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞.
- **–ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ—Ä—Ç–∞–ª–∞ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞:** –º–∞—Å—Ç–µ—Ä ¬´–ü–æ–¥–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–µ–∫—Ç¬ª —Å—Ä–∞–∑—É —Å–æ–∑–¥–∞—ë—Ç –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Å—Å—ã–ª–∫—É –ø–æ—Ä—Ç–∞–ª–∞ –ø—Ä–∏ —Å–≤—è–∑–∫–µ —Ä–µ–∫–ª–∞–º–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞ —Å —á–∞—Ç-–≥—Ä—É–ø–ø–æ–π, –ø–æ—ç—Ç–æ–º—É –ø–µ—Ä–≤—ã–π –æ—Ç—á—ë—Ç –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–∞–±–æ—á—É—é –∫–Ω–æ–ø–∫—É ¬´–ü–æ—Ä—Ç–∞–ª¬ª.
- **–°—Ç–∞–±–∏–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –ø–æ—Ä—Ç–∞–ª—É:** –ø–æ–¥–ø–∏—Å—å —Å—Å—ã–ª–∫–∏ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –ø–æ –≤—Å–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–º —Ç–æ–∫–µ–Ω–∞–º –ø—Ä–æ–µ–∫—Ç–∞ (–≤–∫–ª—é—á–∞—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ, –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∏ —Å–µ—Ä–≤–∏—Å–Ω—ã–µ), –ø–æ—ç—Ç–æ–º—É –ø–æ—Ä—Ç–∞–ª –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –æ—Ç–∫—Ä—ã–≤–∞—Ç—å—Å—è –¥–∞–∂–µ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–∫–∏ –∏–ª–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –≤ KV.
- **–ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –ø—Ä–æ–µ–∫—Ç–∞–º:** —Ä–∞–∑–¥–µ–ª ¬´üìÅ –ü—Ä–æ–µ–∫—Ç—ã¬ª –≤—ã–≤–æ–¥–∏—Ç –∫–∞—Ä—Ç–æ—á–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤ –∫–Ω–æ–ø–∫–∞–º–∏ (–Ω–∞–∑–≤–∞–Ω–∏–µ + —á–∞—Ç), –∞ —Å–≤–æ–±–æ–¥–Ω—ã–µ —Ä–µ–∫–ª–∞–º–Ω—ã–µ –∫–∞–±–∏–Ω–µ—Ç—ã –ø–µ—Ä–µ–µ—Ö–∞–ª–∏ –≤ —Ä–∞–∑–¥–µ–ª ¬´üÜï –ù–æ–≤—ã–µ –†–ö¬ª, –æ—Ç–∫—É–¥–∞ –∑–∞ –æ–¥–Ω–æ –Ω–∞–∂–∞—Ç–∏–µ –º–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –º–∞—Å—Ç–µ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å —É–∂–µ –≤—ã–±—Ä–∞–Ω–Ω—ã–º –∞–∫–∫–∞—É–Ω—Ç–æ–º.
- **–ì–ª–∞–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å:** –≤–µ—Ä—Ö–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã, –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä Meta –∏ —Å—Ç–∞—Ç—É—Å –≤–µ–±—Ö—É–∫–∞; —Å–≤–æ–±–æ–¥–Ω—ã–µ –∫–∞–±–∏–Ω–µ—Ç—ã –∏ –ø–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—é –¥–æ—Å—Ç—É–ø–Ω—ã –ª–∏—à—å –≤ —Ä–∞–∑–¥–µ–ª–µ ¬´üÜï –ù–æ–≤—ã–µ –†–ö¬ª, –∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç–∞–ª–∞–º–∏ –∏ –æ–ø–ª–∞—Ç–æ–π –≤—ã–Ω–µ—Å–µ–Ω–æ –≤ –∫–∞—Ä—Ç–æ—á–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤.
- **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫–∞–±–∏–Ω–µ—Ç–æ–≤:** –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ Meta –≤ KV —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Å–Ω–∏–º–æ–∫ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ (—Å—Ç–∞—Ç—É—Å, –ø–ª–∞—Ç–µ–∂–∏, CPA),
  –∞ –ø—Ä–æ–µ–∫—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞—é—Ç —Å–≤–µ–∂–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è, –≤–∞–ª—é—Ç—É, –ª–∏–º–∏—Ç—ã –∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –±–µ–∑ –ø–æ–¥–∫–ª—é—á—ë–Ω–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞.
- **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ `/health`:** –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Ç–æ–∫–µ–Ω–∞, —Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–æ–≤ –∏ (–ø–æ —Ñ–ª–∞–≥—É `?ping=telegram`) –¥–∞–Ω–Ω—ã–µ `getWebhookInfo`.
  –ü–∞—Ä–∞–º–µ—Ç—Ä `telegram_logs=1` –ø—Ä–∏–∫–ª–∞–¥—ã–≤–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –≤–µ–±—Ö—É–∫–∞.
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–∫–∏:** –∫–æ–º–∞–Ω–¥–∞ `/pingtest` –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–µ—Å—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–¥—Ä—è–¥ —á–µ—Ä–µ–∑ `waitUntil` ‚Äî —Ç–∞–∫ –ø—Ä–æ—â–µ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ Cloudflare –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤–µ–±—Ö—É–∫ –∏ Telegram –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç–≤–µ—Ç—ã.
- **CI ‚Üí —Å–µ–∫—Ä–µ—Ç—ã ‚Üí Cloudflare:** GitHub Actions –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç —Å–µ–∫—Ä–µ—Ç—ã –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –≤ Secrets –≤–æ—Ä–∫–µ—Ä–∞, –ø–æ—ç—Ç–æ–º—É –æ–¥–Ω–∞–∂–¥—ã –∑–∞–¥–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (`BOT_TOKEN`, `ADMIN_IDS`, `FB_APP_*` –∏ –¥—Ä.) –ø–µ—Ä–µ–µ–∑–∂–∞—é—Ç –≤ Cloudflare –±–µ–∑ —Ä—É—á–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π.
- **–ê–≤—Ç–æ–¥–µ–ø–ª–æ–π –∏ sync-—Å—Ü–µ–Ω–∞—Ä–∏–π:** Workflow `deploy.yml` –≤—ã–∑—ã–≤–∞–µ—Ç `npm run sync:secrets`, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥—Ç—è–≥–∏–≤–∞–µ—Ç –≤—Å–µ –∫–ª—é—á–µ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–≤–∫–ª—é—á–∞—è OAuth/–ø–æ—Ä—Ç–∞–ª/–ø—Ä–µ—Å–µ—Ç—ã) –∏ –ø–µ—Ä–µ–¥–∞—ë—Ç –∏—Ö –≤ Cloudflare, –ø–æ—Å–ª–µ —á–µ–≥–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è `npm run deploy`.
- **–£—Å—Ç–æ–π—á–∏–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ Meta:** –∫–ª–∏–µ–Ω—Ç Graph API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–π `fetch` –∏ —Ä–µ–∑–µ—Ä–≤–Ω—ã–π –≤—ã–∑–æ–≤, —á—Ç–æ–±—ã –æ–±—Ö–æ–¥–∏—Ç—å –æ—à–∏–±–∫—É `Illegal invocation` –≤ –æ–∫—Ä—É–∂–µ–Ω–∏–∏ Cloudflare –∏ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–∞–∂–µ –ø—Ä–∏ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.
- **–ü–ª–∞—Ç—ë–∂–Ω—ã–π —Ü–∏–∫–ª Meta:** –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–ª–∏–∂–∞–π—à–µ–π –æ–ø–ª–∞—Ç–µ, –ª–∏–º–∏—Ç–∞—Ö –∏ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 4 —Ü–∏—Ñ—Ä–∞—Ö –∫–∞—Ä—Ç—ã –ø–æ–¥—Ç—è–≥–∏–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º –∑–∞–ø—Ä–æ—Å–æ–º –∫ `adspaymentcycle`, –æ—à–∏–±–∫–∏ Graph API –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—é—Ç—Å—è –∏ –±–æ–ª—å—à–µ –Ω–µ –ª–æ–º–∞—é—Ç —Å–≤–æ–¥–∫—É.
- **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Å—Ç–∞—Ç—É—Å–∞:** —Ü–≤–µ—Ç —Å—Ç–∞—Ç—É—Å–∞ –∫–∞–±–∏–Ω–µ—Ç–∞ —Ç–µ–ø–µ—Ä—å –æ—Å–Ω–æ–≤—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–ª–∞—Ç—ë–∂–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º–∞—Ö –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞—Ö ‚Äî –∞–∫—Ç–∏–≤–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã –±–µ–∑ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –æ—Å—Ç–∞—é—Ç—Å—è –∑–µ–ª—ë–Ω—ã–º–∏, –¥–∞–∂–µ –µ—Å–ª–∏ –µ—Å—Ç—å —Ç–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å –∫ –æ–ø–ª–∞—Ç–µ.
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:** `npm run test:integration` –ø—Ä–æ–≥–æ–Ω—è–µ—Ç —Å—Ü–µ–Ω–∞—Ä–∏–∏ Meta OAuth, `/manage/meta` –∏ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –ø–æ—Ä—Ç–∞–ª–∞ –ø–æ –±–æ–µ–≤–æ–º—É URL –≤–æ—Ä–∫–µ—Ä–∞.
- **–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π runbook:** –≤ `docs/runbook.md` –æ–ø–∏—Å–∞–Ω—ã —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ —Å–±–æ–∏ (Telegram, Meta, –ø–æ—Ä—Ç–∞–ª), –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –¥–µ–ø–ª–æ—è/–æ—Ç–∫–∞—Ç–∞ –∏ —ç—Å–∫–∞–ª–∞—Ü–∏–∏.
- **Go-live —á–µ–∫-–ª–∏—Å—Ç:** –¥–æ–∫—É–º–µ–Ω—Ç `docs/go-live-checklist.md` –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º (—Å–µ–∫—Ä–µ—Ç—ã, Meta OAuth, –æ—Ç—á—ë—Ç—ã, –ø–æ—Ä—Ç–∞–ª, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥).

## –°—Ä–æ—á–Ω—ã–µ –∑–∞–¥–∞—á–∏ (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞ 2025-11-10)
- ‚úÖ –ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∞—Ç—å –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –ø–æ—Ä—Ç–∞–ª: –æ–±–Ω–æ–≤–ª—ë–Ω–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –æ–ø–ª–∞—Ç—ã, —Ñ–∏–ª—å—Ç—Ä—ã/—Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∫–∞–º–ø–∞–Ω–∏–π –∏ API `/api/meta/status` –≤–º–µ—Å—Ç–æ CSV.
- ‚úÖ –°–æ–∫—Ä–∞—Ç–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ KV: –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ `session:/admin:session:` –∏ `meta:auth`, –¥–æ–±–∞–≤–∏—Ç—å fallback `_fallback=true` –∏ R2-–ª–æ–≥–∏ `logs/{date}.json`.
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç—á—ë—Ç—ã –∏ –∫–∞—Ä—Ç–æ—á–∫–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤: –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä —Ü–µ–ª–µ–≤–æ–π –º–µ—Ç—Ä–∏–∫–∏, –∫–æ–º–ø–∞–∫—Ç–Ω—ã–µ –∫–∞–º–ø–∞–Ω–∏–∏, –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã –¥–ª—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –∏ –∞–ª–µ—Ä—Ç–æ–≤.
- ‚è≥ –ü–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∏–ª–ª–∏–Ω–≥–æ–≤—ã–µ –∞–ª–µ—Ä—Ç—ã –Ω–∞ –±–æ–µ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —É–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ —Ä–µ–∞–ª—å–Ω–æ–π –æ—à–∏–±–∫–µ –æ–ø–ª–∞—Ç—ã.
- ‚è≥ –ü—Ä–æ–π—Ç–∏ —Ñ–∏–Ω–∞–ª—å–Ω—É—é –ø—Ä–∏—ë–º–∫—É go-live –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–º –≤–æ—Ä–∫–µ—Ä–µ –∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞.

## –ß—Ç–æ –ø—Ä–µ–¥—Å—Ç–æ–∏—Ç —Å–¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ
1. ~~–î–æ–ø–æ–ª–Ω–∏—Ç—å –º–∞—Å—Ç–µ—Ä –ø—Ä–æ–µ–∫—Ç–æ–≤: –¥–æ–±–∞–≤–∏—Ç—å –≤—ã–±–æ—Ä —á–∞—Ç–æ–≤—ã—Ö –ø—Ä–µ—Å–µ—Ç–æ–≤, –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∞–∫–∫–∞—É–Ω—Ç–∞–º.~~ (–≥–æ—Ç–æ–≤–æ: –ø—Ä–µ—Å–µ—Ç—ã, –∫–æ–Ω—Ç—Ä–æ–ª—å –ø—Ä–∞–≤ –∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±–µ–∑ –¥—É–±–ª–µ–π)
2. ~~–†–∞—Å—à–∏—Ä–∏—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏ Meta: —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –∫–∞–∂–¥–æ–º—É —Ä–µ–∫–ª–∞–º–Ω–æ–º—É –∫–∞–±–∏–Ω–µ—Ç—É –∏ –æ–±–Ω–æ–≤–ª—è—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.~~ (–≥–æ—Ç–æ–≤–æ: —Å–Ω–∏–º–æ–∫ KV, –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–≤ –∏ –∫–∞—Ä—Ç–æ—á–µ–∫)
3. ~~–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è OAuth, –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –ø–æ—Ä—Ç–∞–ª–∞ –∏ —Ñ–æ—Ä–º –∞–¥–º–∏–Ω–∫–∏ (—Ö–æ—Ç—è –±—ã —Å–∫—Ä–∏–ø—Ç—ã —Ä—É—á–Ω–æ–≥–æ –ø—Ä–æ–≥–æ–Ω–∞ –∏–ª–∏ –∫–æ–ª–ª–µ–∫—Ü–∏—é Postman).~~ (–≥–æ—Ç–æ–≤–æ: —Å–∫—Ä–∏–ø—Ç `test:integration` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–µ–¥–∏—Ä–µ–∫—Ç OAuth, `/manage/meta` –∏ –ø–æ—Ä—Ç–∞–ª)
4. ~~–°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å –¥–µ–ø–ª–æ–π: –≤–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–¥–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ GitHub Actions –∏ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ–¥—É—Ä—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤/–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.~~ (–≥–æ—Ç–æ–≤–æ: —Å–∫—Ä–∏–ø—Ç `sync-secrets`, workflow –æ–±–Ω–æ–≤–ª—è–µ—Ç –≤—Å–µ –∫–ª—é—á–∏, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤ `docs/deployment.md`)
5. ~~–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π runbook: –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ä—è–¥–æ–∫ —Ä—É—á–Ω–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è, –æ—Ç–∫–∞—Ç–∞ –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Cloudflare/Telegram.~~ (–≥–æ—Ç–æ–≤–æ: –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è `docs/runbook.md` –∏ –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π —Ä–∞–∑–¥–µ–ª README)
6. ~~–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å go-live —á–µ–∫-–ª–∏—Å—Ç: –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ —Ç–æ—á–∫–∏ –∏ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏ –ø–µ—Ä–µ–¥ —à–∏—Ä–æ–∫–∏–º —Ä–µ–ª–∏–∑–æ–º.~~ (–≥–æ—Ç–æ–≤–æ: –¥–æ–∫—É–º–µ–Ω—Ç `docs/go-live-checklist.md` –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏)
7. ~~–ü–µ—Ä–µ–≤–µ—Å—Ç–∏ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–æ—Ä–º—ã (KPI, —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è, –∞–ª–µ—Ä—Ç—ã) –Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∫–Ω–æ–ø–æ—á–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å~~ ‚Äî –≥–æ—Ç–æ–≤–æ: —Ä–µ–¥–∞–∫—Ç–æ—Ä—ã KPI –∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π —Ä–∞–±–æ—Ç–∞—é—Ç —á–µ—Ä–µ–∑ –∏–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫–∏, —Ä—É—á–Ω–æ–π –≤–≤–æ–¥ –±–æ–ª—å—à–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è. –ü—Ä–∏—ë–º–∫–∞ go-live –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –∑–∞–≤–µ—Ä—à–∞—é—â–∏–º —à–∞–≥–æ–º.

## –ü–ª–∞–Ω —Ç–µ–∫—É—â–µ–≥–æ —ç—Ç–∞–ø–∞

1. ~~**–†–µ–¥–∞–∫—Ç–æ—Ä KPI –∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π** ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ü–µ–ª–µ–π –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π –ø—Ä—è–º–æ –∏–∑ Telegram —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ KV.~~ (–≥–æ—Ç–æ–≤–æ)
2. ~~**–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –æ—Ç—á—ë—Ç–æ–≤** ‚Äî —Å–≤—è–∑–∞—Ç—å –±—ã—Å—Ç—Ä—ã–µ –ø—Ä–µ—Å–µ—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏ –∫ Meta –∏ —Ä–∞—Å—Å—ã–ª–∫—É –ø–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–º —á–∞—Ç–∞–º.~~ (–≥–æ—Ç–æ–≤–æ: –∂–∏–≤—ã–µ –≤—ã–≥—Ä—É–∑–∫–∏, –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é)
3. ~~**–ê–ª–µ—Ä—Ç—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏** ‚Äî –≤–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω—É–ª–µ–≤–æ–≥–æ —Ä–∞—Å—Ö–æ–¥–∞, –ø–ª–∞—Ç–µ–∂–µ–π, –∞–Ω–æ–º–∞–ª–∏–π –∏ —É—Å—Ç–∞–ª–æ—Å—Ç–∏ –∫—Ä–µ–∞—Ç–∏–≤–æ–≤ —Å –∂—É—Ä–Ω–∞–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º –¥–µ–π—Å—Ç–≤–∏–π –∞–¥–º–∏–Ω–æ–≤.~~ (–≥–æ—Ç–æ–≤–æ: —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ –ø—Ä–æ–µ–∫—Ç—ã –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º, —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è –≤ KV)
4. ~~**–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –ø–æ—Ä—Ç–∞–ª–∞** ‚Äî —Å–æ–±—Ä–∞—Ç—å –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (–°–µ–≥–æ–¥–Ω—è/–í—á–µ—Ä–∞/7 –¥–Ω–µ–π/–ú–¢–î) –∏ –∫–Ω–æ–ø–∫—É ¬´–ù–∞–ø–∏—Å–∞—Ç—å –≤ —á–∞—Ç¬ª, –æ–ø–∏—Å–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.~~ (–≥–æ—Ç–æ–≤–æ: —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –∞–≥—Ä–µ–≥–∞—Ç–∞–º–∏, —Ç–æ–ø-–∫–∞–º–ø–∞–Ω–∏–∏ –∏ –∫–Ω–æ–ø–∫–∞ —Å–≤—è–∑–∏)
5. ~~**–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –ø–æ—Ä—Ç–∞–ª–∞** ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –ø–æ—è—Å–Ω–µ–Ω–∏—è –∏ —Ñ–æ—Ä–º—É –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤.~~ (–≥–æ—Ç–æ–≤–æ: –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∏–Ω—Å–∞–π—Ç—ã –∏ —Ñ–æ—Ä–º–∞ ¬´–ù–∞–ø–∏—Å–∞—Ç—å –≤ —á–∞—Ç¬ª —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π —Å–æ–æ–±—â–µ–Ω–∏–π)
6. ~~**–ú–∞—Å—Ç–µ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–æ–≤** ‚Äî –¥–æ–≤–µ—Å—Ç–∏ –¥–∏–∞–ª–æ–≥ `admin:project:connect`: –≤–∞–ª–∏–¥–∞—Ü–∏—è, –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ KPI/—Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π, –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.~~ (–≥–æ—Ç–æ–≤–æ: –≤–∞–ª–∏–¥–∞—Ü–∏—è, –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ KPI –∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è –∞–¥–º–∏–Ω–æ–≤ –∏ –ø—Ä–æ–µ–∫—Ç–Ω–æ–≥–æ —á–∞—Ç–∞)
7. ~~**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–µ—Å–µ—Ç–æ–≤ –∏ –ø—Ä–∞–≤** ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –≤—ã–±–æ—Ä —á–∞—Ç–æ–≤—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤, –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∞–∫–∫–∞—É–Ω—Ç–∞–º.~~ (–≥–æ—Ç–æ–≤–æ: –ø—Ä–µ—Å–µ—Ç—ã —á–∞—Ç–æ–≤, –∫–æ–Ω—Ç—Ä–æ–ª—å –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –∏ —Å—Ü–µ–Ω–∞—Ä–∏–π –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è)
8. ~~**–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏ Meta** ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø–æ –∫–∞–±–∏–Ω–µ—Ç–∞–º –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.~~ (–≥–æ—Ç–æ–≤–æ: KV-—Å–Ω–∏–º–æ–∫, –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–≤, –ø–æ–¥—Å–∫–∞–∑–∫–∏ –≤ –∞–¥–º–∏–Ω–∫–µ)
9. ~~**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏** ‚Äî —Å–æ–±—Ä–∞—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–∏ (Postman/—Å–∫—Ä–∏–ø—Ç—ã) –¥–ª—è OAuth, –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –ø–æ—Ä—Ç–∞–ª–∞ –∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ–æ—Ä–º –∞–¥–º–∏–Ω–∫–∏.~~ (–≥–æ—Ç–æ–≤–æ: `npm run test:integration` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ URL/—Ç–æ–∫–µ–Ω–æ–≤)
10. ~~**–°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å –¥–µ–ø–ª–æ–π** ‚Äî –≤–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–¥–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ GitHub Actions –∏ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ–¥—É—Ä—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤/–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.~~ (–≥–æ—Ç–æ–≤–æ: `sync-secrets`, README –∏ `docs/deployment.md`)
11. ~~**–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π runbook** ‚Äî –æ–ø–∏—Å–∞—Ç—å –ø–æ—Ä—è–¥–æ–∫ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ —Å–±–æ–∏, —Ä—É—á–Ω–æ–π –æ—Ç–∫–∞—Ç, –∫–æ–Ω—Ç–∞–∫—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏.~~ (–≥–æ—Ç–æ–≤–æ: runbook –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω –≤ `docs/runbook.md` –∏ –≤—ã–Ω–µ—Å–µ–Ω –≤ —Ä–∞–∑–¥–µ–ª ¬´–ß—Ç–æ —É–∂–µ –≥–æ—Ç–æ–≤–æ¬ª)
12. ~~**Go-live —á–µ–∫-–ª–∏—Å—Ç** ‚Äî —Å–æ–±—Ä–∞—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–≤–µ—Ä–æ–∫ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å, —Ç–æ—á–∫–∏ —Å–≤—è–∑–∏).~~ (–≥–æ—Ç–æ–≤–æ: —Å–º. `docs/go-live-checklist.md`)
13. **Go-live –ø—Ä–∏—ë–º–∫–∞** ‚Äî –ø—Ä–æ–π—Ç–∏ —á–µ–∫-–ª–∏—Å—Ç –Ω–∞ —Ä–∞–±–æ—á–µ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏, –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞.

### –°—Ä–æ—á–Ω—ã–µ –∑–∞–¥–∞—á–∏ –ø–æ—Å–ª–µ —Ç–µ–∫—É—â–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

* –ü–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∏–ª–ª–∏–Ω–≥–æ–≤—ã–µ –∞–ª–µ—Ä—Ç—ã –Ω–∞ –±–æ–µ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –æ–ø–ª–∞—Ç—ã –æ—Ç–ø—Ä–∞–≤–ª—è–ª–æ—Å—å —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ —Ä–µ–∞–ª—å–Ω–æ–π –ø—Ä–æ–±–ª–µ–º–µ.
* –ü—Ä–æ–≤–µ—Å—Ç–∏ —Ñ–∏–Ω–∞–ª—å–Ω—É—é –ø—Ä–∏—ë–º–∫—É go-live –ø–æ —á–µ–∫-–ª–∏—Å—Ç—É –∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å—Ç–∑–∞–ø—É—Å–∫–æ–≤–æ–µ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ.

## –¢—Ä–µ–±—É–µ–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è            | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                              | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|-----------------------|------------------------------------------|-------------|------------------------|
| `BOT_TOKEN` / –∞–ª–∏–∞—Å—ã  | –¢–æ–∫–µ–Ω Telegram-–±–æ—Ç–∞                      | –¥–∞          | ‚Äî                      |
| `ADMIN_IDS`           | –°–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é     | —á–∞—Å—Ç–∏—á–Ω–æ    | `7623982602,573424022` |
| `DEFAULT_TZ`          | –¢–∞–π–º–∑–æ–Ω–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, `Asia/Tashkent`) | —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è | ‚Äî |
| `WORKER_URL`          | –ü—É–±–ª–∏—á–Ω—ã–π URL –≤–æ—Ä–∫–µ—Ä–∞ (–¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏) | —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è | –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∏–∑ –∑–∞–ø—Ä–æ—Å–∞, –º–æ–∂–Ω–æ –Ω–µ –∑–∞–¥–∞–≤–∞—Ç—å |
| `FB_APP_ID`           | –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä Meta –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è            | –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è | ‚Äî |
| `FB_APP_SECRET`       | –°–µ–∫—Ä–µ—Ç Meta –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è                   | –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è | ‚Äî |
| `META_LONG_TOKEN` / `META_ACCESS_TOKEN` | Long-lived —Ç–æ–∫–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è/—Å–∏—Å—Ç–µ–º—ã Meta –¥–ª—è —á—Ç–µ–Ω–∏—è —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ | —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è | ‚Äî |
| `FB_GRAPH_VERSION` / `META_GRAPH_VERSION` | –í–µ—Ä—Å–∏—è Graph API –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Meta | –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ | `v18.0` |
| `GS_WEBHOOK`          | –í–µ–±—Ö—É–∫ Google Apps Script (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)  | –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ | ‚Äî |
| `META_MANAGE_TOKEN`   | –¢–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–∞ –∫ `/manage/meta`            | —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è | ‚Äî |
| `PORTAL_TOKEN` / `PORTAL_SIGNING_SECRET` | –û–±—â–∏–π —Å–µ–∫—Ä–µ—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å—Å—ã–ª–æ–∫ `/p/{code}?sig=...` | –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ | ‚Äî |
| `PROJECT_MANAGER_IDS` | ID –∞–¥–º–∏–Ω–æ–≤, –∫–æ—Ç–æ—Ä—ã–º —Ä–∞–∑—Ä–µ—à–µ–Ω–æ –ø–æ–¥–∫–ª—é—á–∞—Ç—å/–æ–±–Ω–æ–≤–ª—è—Ç—å –ø—Ä–æ–µ–∫—Ç—ã | –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ | –í—Å–µ `ADMIN_IDS` |
| `PROJECT_ACCOUNT_ACCESS` | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–∫–∫–∞—É–Ω—Ç–∞–º (`{"act_123": ["7623982602"]}`) | –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ | ‚Äî |
| `PROJECT_CHAT_PRESETS` | –ü—Ä–µ—Å–µ—Ç—ã —á–∞—Ç–æ–≤ (`{"sales": {"chatId": "-100‚Ä¶", "threadId": "5"}}`) | –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ | ‚Äî |
| `R2_ACCESS_KEY_ID` / `R2_SECRET_ACCESS_KEY` | –ö–ª—é—á –∏ —Å–µ–∫—Ä–µ—Ç –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ R2 `botbucket` | –¥–∞ | ‚Äî |
| `R2_BUCKET_NAME`       | –ò–º—è R2-–±–∞–∫–µ—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `botbucket`) | –¥–∞ | `botbucket` |
| `R2_ENDPOINT`          | Endpoint R2 API                           | –¥–∞ | ‚Äî |
| `R2_ACCOUNT_ID`        | –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∞–∫–∫–∞—É–Ω—Ç–∞ R2                 | –¥–∞ | ‚Äî |

> –°–µ–∫—Ä–µ—Ç—ã –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—è—Ç—Å—è –≤ git. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `wrangler secret put`, `.dev.vars`/`.env` –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –∏–ª–∏ GitHub Actions secrets.

## –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –∫–ª—é—á–∏ –∏ —Ç–æ–∫–µ–Ω—ã

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —à–∞–±–ª–æ–Ω `.dev.vars.example` –≤ `.dev.vars` (Cloudflare —á–∏—Ç–∞–µ—Ç –µ–≥–æ –≤ —Ä–µ–∂–∏–º–µ `wrangler dev`).
2. –ü—Ä–æ–ø–∏—à–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ `KEY="value"`. –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä —É–∂–µ –ø–æ–∫–∞–∑–∞–Ω –≤ —à–∞–±–ª–æ–Ω–µ, –Ω–æ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –ø—Ä–∏–≤–µ–¥—ë–Ω –Ω–∏–∂–µ:
   ```env
   BOT_TOKEN="<—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞_–∏–∑_@BotFather>"
   ADMIN_IDS="7623982602,573424022"
   DEFAULT_TZ="Asia/Tashkent"
   ```
3. –î–ª—è –∑–∞–ø—É—Å–∫–∞ —á–µ—Ä–µ–∑ Node.js –∏–ª–∏ –¥—Ä—É–≥–∏—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å —Ç–µ –∂–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ `.env`.
4. –°–∫—Ä–∏–ø—Ç—ã `npm run check:config` –∏ `npm run sync:secrets` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Ö–≤–∞—Ç—ã–≤–∞—é—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ `.env`, –ø–æ—ç—Ç–æ–º—É –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Ñ–∞–π–ª –≤ –∞–∫—Ç—É–∞–ª—å–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏.
5. –ß—Ç–æ–±—ã –±—ã—Å—Ç—Ä–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ Cloudflare, —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –∏—Ö –≤ —Ç–µ–∫—É—â—É—é —Å–µ—Å—Å–∏—é (`export FB_APP_ID=...`) –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ `npm run sync:secrets -- --env production`.

> `.dev.vars` –∏ `.env` –Ω–µ –∫–æ–º–º–∏—Ç—è—Ç—Å—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π ‚Äî —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª—ã –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –≤ `.gitignore` (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ).

### GitHub Actions ‚Üí Cloudflare
1. –í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ GitHub –æ—Ç–∫—Ä–æ–π—Ç–µ **Settings ‚Üí Secrets and variables ‚Üí Actions** –∏ –∑–∞–¥–∞–π—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã: `BOT_TOKEN`, `ADMIN_IDS`,
   `DEFAULT_TZ`, `WORKER_URL`, `FB_APP_ID`, `FB_APP_SECRET`, `FB_LONG_TOKEN`/`META_LONG_TOKEN`, `META_MANAGE_TOKEN`, `PORTAL_TOKEN`,
   `PROJECT_MANAGER_IDS`, `PROJECT_ACCOUNT_ACCESS`, `PROJECT_CHAT_PRESETS`, `GS_WEBHOOK`, –∞ —Ç–∞–∫–∂–µ —Å–≤—è–∑–∫—É R2 (`R2_ACCESS_KEY_ID`,
   `R2_SECRET_ACCESS_KEY`, `R2_BUCKET_NAME`, `R2_ENDPOINT`, `R2_ACCOUNT_ID`).
2. –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –¥–µ–ø–ª–æ–µ workflow –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑–æ–≤–µ—Ç `npm run sync:secrets -- --env production` –∏ –ø–µ—Ä–µ–Ω–µ—Å—ë—Ç –∑–Ω–∞—á–µ–Ω–∏—è –≤ Cloudflare.
   –í workflow –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è –≤—Å–µ `R2_*` —Å–µ–∫—Ä–µ—Ç—ã, –ø–æ—ç—Ç–æ–º—É –ø—Ä–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–¥–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–µ –±—É–¥–µ—Ç –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å R2.
3. –í –ª–æ–≥–∞—Ö –ø–æ—è–≤—è—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è `‚úÖ Synced secret <KEY>` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –∫–ª—é—á–∞; –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ—Ç–º–µ—á–∞–µ—Ç—Å—è —Å—Ç—Ä–æ–∫–æ–π `‚ö†Ô∏è –ü—Ä–æ–ø—É—Å–∫`.
4. –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –æ–ø–∏—Å–∞–Ω –≤ `docs/deployment.md` (–ø–æ—à–∞–≥–æ–≤—ã–π –≥–∞–π–¥ –ø–æ –¥–µ–ø–ª–æ—é –∏ —Ä–æ—Ç–∞—Ü–∏–∏ —Å–µ–∫—Ä–µ—Ç–æ–≤).

### –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ã–π –≤–æ—Ä–∫–µ—Ä –≤ Cloudflare –≤—Ä—É—á–Ω—É—é
1. –í—ã–ø–æ–ª–Ω–∏—Ç–µ `npx wrangler secret put BOT_TOKEN` –∏ –≤—Å—Ç–∞–≤—å—Ç–µ —Ç–æ–∫–µ–Ω –∏–∑ @BotFather.
2. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å `ADMIN_IDS`, `DEFAULT_TZ` –∏ –¥—Ä—É–≥–∏–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (`wrangler secret put <KEY>`).
3. –õ–∏–±–æ –æ—Ç–∫—Ä–æ–π—Ç–µ Cloudflare Dashboard ‚Üí Workers & Pages ‚Üí –Ω—É–∂–Ω—ã–π –≤–æ—Ä–∫–µ—Ä ‚Üí **Settings** ‚Üí **Variables** ‚Üí **Add variable/secret**.
4. –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –¥–µ–ø–ª–æ–π: `npm run deploy` –∏–ª–∏ GitHub Actions.

### –ü—Ä–æ–≤–µ—Ä–∫–∞
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `npm run check:config -- --ping-telegram` ‚Äî —Å–∫—Ä–∏–ø—Ç –Ω–∞–π–¥—ë—Ç —Ç–æ–∫–µ–Ω –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç `getMe`.
2. –í –±—Ä–∞—É–∑–µ—Ä–µ –æ—Ç–∫—Ä–æ–π—Ç–µ `/health?ping=telegram` ‚Äî —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–æ—Ä–∫–µ—Ä –≤–∏–¥–∏—Ç —Ç–æ–∫–µ–Ω –∏ —Ç–µ–∫—É—â–∏–π webhook.
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –≤ Telegram `/pingtest` ‚Äî –±–æ—Ç –≤–µ—Ä–Ω—ë—Ç 10 —Å–æ–æ–±—â–µ–Ω–∏–π, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—è –¥–æ—Å—Ç–∞–≤–∫—É.

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

–°–∫—Ä–∏–ø—Ç `npm run test:integration` –ø–æ–º–æ–≥–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∂–∏–≤–æ–π –≤–æ—Ä–∫–µ—Ä –Ω–∞ –∫–ª—é—á–µ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö:

1. **Meta OAuth** ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–µ–¥–∏—Ä–µ–∫—Ç `/fb_auth` –≤ Facebook.
2. **API Meta** ‚Äî –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç `/manage/meta` –∏ —É–±–µ–∂–¥–∞–µ—Ç—Å—è, —á—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∞–∫—Ç—É–∞–ª—å–Ω–∞—è —Å–≤–æ–¥–∫–∞.
3. **–ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π –ø–æ—Ä—Ç–∞–ª** ‚Äî –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç `/p/{code}?sig=...` –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ HTML —Å–æ–¥–µ—Ä–∂–∏—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ –±–ª–æ–∫–∏.

–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—É—Å–∫–∞:

```bash
# –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ (URL –∏ —Ç–æ–∫–µ–Ω—ã –±–µ—Ä—É—Ç—Å—è –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è)
npm run test:integration -- --base https://<worker>.workers.dev \\
  --meta-token <META_MANAGE_TOKEN> \\
  --portal-code <projectCode> \\
  --portal-sig <portalSignature>

# –ú–æ–∂–Ω–æ –∑–∞–¥–∞–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —á–µ—Ä–µ–∑ ENV
export INTEGRATION_BASE_URL="https://<worker>.workers.dev"
export INTEGRATION_META_TOKEN="<META_MANAGE_TOKEN>"
export INTEGRATION_PORTAL_CODE="<projectCode>"
export INTEGRATION_PORTAL_SIG="<portalSignature>"
npm run test:integration
```

–ï—Å–ª–∏ —Ç–æ–∫–µ–Ω—ã –∏–ª–∏ –ø–æ–¥–ø–∏—Å–∏ –Ω–µ –∑–∞–¥–∞–Ω—ã, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±—É–¥—É—Ç –ø—Ä–æ–ø—É—â–µ–Ω—ã —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º.

## –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π –ø–æ—Ä—Ç–∞–ª

1. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ—Ä—Ç–∞–ª –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –ø—Ä—è–º–æ –∏–∑ –∫–∞—Ä—Ç–æ—á–∫–∏ (¬´üåê –ü–æ—Ä—Ç–∞–ª¬ª ‚Üí ¬´‚ú® –°–æ–∑–¥–∞—Ç—å –ø–æ—Ä—Ç–∞–ª¬ª) ‚Äî –≤–æ—Ä–∫–µ—Ä —Å–∞–º —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–æ–∫–µ–Ω –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç –µ–≥–æ –≤ KV (`portal.token`). –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤—Ä—É—á–Ω—É—é (`client.portal.secret`, `portal_tokens` –∏ —Ç.–ø.).
2. –°—Å—ã–ª–∫–∞ –∏–º–µ–µ—Ç –≤–∏–¥ `https://<worker>/p/<code>?sig=<–∑–Ω–∞—á–µ–Ω–∏–µ>`: –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ —Å–∞–º —Ç–æ–∫–µ–Ω, —Ç–∞–∫ –∏ —Ö–µ—à `sha256(<code>:<token>)`. –í—Ç–æ—Ä–æ–π –≤–∞—Ä–∏–∞–Ω—Ç —É–¥–æ–±–Ω–æ –≤—ã–¥–∞–≤–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–∞–º, –Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞—è –∏—Å—Ö–æ–¥–Ω—ã–π —Å–µ–∫—Ä–µ—Ç. –ü—Ä–∏ –æ—Ç–º–µ—Ç–∫–µ ¬´–û—Ç–∫–∞–∑–∞–ª—Å—è –æ–ø–ª–∞—á–∏–≤–∞—Ç—å¬ª –ø–æ—Ä—Ç–∞–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è –∏ —Å—Å—ã–ª–∫–∞ –ø–µ—Ä–µ—Å—Ç–∞—ë—Ç —Ä–∞–±–æ—Ç–∞—Ç—å.
3. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–π —Å–µ–∫—Ä–µ—Ç —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `PORTAL_TOKEN`/`PORTAL_SIGNING_SECRET` ‚Äî –æ–Ω –ø–æ–¥–æ–π–¥—ë—Ç –¥–ª—è —ç–∫—Å–ø—Ä–µ—Å—Å-–¥–æ—Å—Ç—É–ø–∞ –∏–ª–∏ –æ—Ç–ª–∞–¥–∫–∏.
4. –ü–∞—Ä–∞–º–µ—Ç—Ä `refresh=1` –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–∏—Ç Meta-–¥–∞–Ω–Ω—ã–µ –¥–æ —Ä–µ–Ω–¥–µ—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã. –û—Å—Ç–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (—Ñ–∏–ª—å—Ç—Ä –∫–∞–º–ø–∞–Ω–∏–π, —Ç–∞–π–º–∑–æ–Ω–∞ `Asia/Tashkent` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) –ø–æ–¥—Ç—è–≥–∏–≤–∞—é—Ç—Å—è –∏–∑ –ø—Ä–æ–µ–∫—Ç–∞.
5. –í —Ñ–æ–Ω–µ –ø–æ—Ä—Ç–∞–ª –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ `GET /api/meta/status?code=...&period=...&sig=...` ‚Äî —ç–Ω–¥–ø–æ–∏–Ω—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å, –ø–æ–¥–≥—Ä—É–∂–∞–µ—Ç —Å–≤–µ–∂–∏–π –ø–µ—Ä–∏–æ–¥ –∏ –æ—Ç–¥–∞—ë—Ç –∫–∞–º–ø–∞–Ω–∏–∏ –≤ –Ω–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ (—Å—Ç–∞—Ç—É—Å + –∫–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –≤ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ).

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–Ω–∞ –ø—Ä–æ–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è npx, –Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å install)
npm install

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –æ–∫—Ä—É–∂–µ–Ω–∏—è (—Å–∫—Ä–∏–ø—Ç –±—É–¥–µ—Ç —É–ø—Ä–æ—â—ë–Ω –Ω–∞ —Å–ª–µ–¥—É—é—â–∏—Ö —ç—Ç–∞–ø–∞—Ö)
npm run check:config

# –ó–∞–ø—É—Å—Ç–∏—Ç—å dev-—Å–µ—Ä–≤–µ—Ä Cloudflare Workers
npm run dev

# –î–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ Wrangler (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç wrangler.toml)
npm run deploy
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è
1. `GET https://<worker>/health` ‚Äî —É–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ `ok: true` –∏ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã.
2. `GET https://<worker>/health?ping=telegram&telegram_logs=1` ‚Äî –≤–∏–¥–∏–º `getWebhookInfo` –∏ —Å–≤–µ–∂–∏–µ —Å–æ–±—ã—Ç–∏—è –≤–µ–±—Ö—É–∫–∞.
3. –í Telegram –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º `/start`, `/help`, `/register`, `/admin`, `/pingtest` –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã.
4. `/pingtest` –¥–æ–ª–∂–µ–Ω –ø—Ä–∏—Å–ª–∞—Ç—å –¥–µ—Å—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–π –∑–∞ –¥–µ—Å—è—Ç—å —Å–µ–∫—É–Ω–¥ (—Ä–∞–∑—Ä–µ—à–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å Cloudflare ‚Üî Telegram).

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –±—É–¥–µ—Ç —Ä–∞—Å—à–∏—Ä—è—Ç—å—Å—è –ø–æ –º–µ—Ä–µ —Ä–æ—Å—Ç–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏.

## Client Portal Specification

üß© **TASK: Expand README.md and implement client analytics portal for Facebook Ads bot**

---

## üìò CONTEXT

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç (`buyclientuz-pixel/targetbot`) –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π Telegram + Facebook Ads –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –±–æ—Ç–∞, —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç–æ–≥–æ –Ω–∞ **Cloudflare Workers**.
–ë–∞–∑–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ (webhook, KV, R2, deployment, auth) —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Äî —Ç–µ–ø–µ—Ä—å –Ω–∞–º –Ω—É–∂–µ–Ω –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π **–∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π –≤–µ–±-–ø–æ—Ä—Ç–∞–ª** –∏ **–∞–¥–º–∏–Ω-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**
—Å –∫—ç—à–µ–º –Ω–∞ R2, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π –∏ —É–ª—É—á—à–µ–Ω–Ω—ã–º UX.

---

## üß† OBJECTIVE

–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å **–ø–æ—Ä—Ç–∞–ª –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç–∏** –ø–æ –∞–¥—Ä–µ—Å—É `/portal/:project_id` –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—É—é **–∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å** `/admin`, –∫–æ—Ç–æ—Ä—ã–µ:
- –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–æ–µ–∫—Ç–æ–≤, –¥–∞–Ω–Ω—ã–µ –∫–∞–º–ø–∞–Ω–∏–π –∏ KPI;
- –ø–æ–ª—É—á–∞—é—Ç —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ Facebook Graph API;
- —Å–æ—Ö—Ä–∞–Ω—è—é—Ç –≤—Å—ë –≤ R2 (KV –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–µ—Å—Å–∏–π/—Ç–æ–∫–µ–Ω–æ–≤);
- –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤ –∏ –∫–ª–∏–µ–Ω—Ç–æ–≤.

---

## üîπ SYSTEM ARCHITECTURE

```
src/
 ‚îú‚îÄ‚îÄ index.js               # main worker entry
 ‚îú‚îÄ‚îÄ api/                   # backend routes
 ‚îú‚îÄ‚îÄ views/                 # portal/admin HTML templates
 ‚îú‚îÄ‚îÄ fb/                    # Facebook Graph helpers
 ‚îî‚îÄ‚îÄ utils/                 # shared modules (cache, formatters, R2, errors)
r2/
 ‚îú‚îÄ‚îÄ reports/{project_id}.json
 ‚îú‚îÄ‚îÄ logs/{date}.json
 ‚îî‚îÄ‚îÄ meta/
```

---

## üîπ NEW ROUTES

| Endpoint | Method | Purpose |
|-----------|---------|----------|
| `/portal/:project_id` | GET | Client portal (summary view) |
| `/portal/:project_id/campaigns` | GET | Full campaign table (active + inactive) |
| `/api/meta/status` | GET | Facebook auth + account status |
| `/api/projects` | GET | List of all client projects |
| `/api/project/:id` | GET | Detailed metrics from R2 |
| `/api/project/:id/refresh` | POST | Force refresh (FB ‚Üí R2) |
| `/api/tg/alert` | POST | Send Telegram alert (CPA/CTR threshold exceeded) |

---

## üîπ ADMIN PANEL (`/admin`)

**Access:** `?key=ADMIN_KEY`

–†–∞–∑–¥–µ–ª—ã:
1. –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Facebook (üü¢ / üü° / üî¥)
2. –†–µ–∫–ª–∞–º–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã (–∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å, —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã, –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)
3. –°–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤ (–∫–∞—Ä—Ç–æ—á–∫–∏ ‚Üí –ø–µ—Ä–µ—Ö–æ–¥ –≤ –ø–æ—Ä—Ç–∞–ª)
4. –õ–æ–≥–∏ (R2/logs)
5. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞–º–∏
6. –ö–Ω–æ–ø–∫–∞ ¬´Refresh All¬ª

---

## üîπ CLIENT PORTAL (`/portal/:project_id`)

### üìã **Card Design**

```
üü¢ Project Name (Example Client)
üìÖ –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 10.11.2025, 17:00
üí≥ –ö–∞—Ä—Ç–∞: ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ 2345
üìÜ –û–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑: 24–¥
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üìà –ê–∫—Ç–∏–≤–Ω—ã–µ –∫–∞–º–ø–∞–Ω–∏–∏: 6
üí∞ –ü–æ—Ç—Ä–∞—á–µ–Ω–æ: $428.43
üì≤ –õ–∏–¥—ã: 63 | –ö–ª–∏–∫–∏: 742 | –ü–æ–∫–∞–∑—ã: 28.5K | –ß–∞—Å—Ç–æ—Ç–∞: 2.1
CPA: $6.79 | CPC: $0.58 | CTR: 2.6%
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üîó [–í—Å–µ –∫–∞–º–ø–∞–Ω–∏–∏] | üí¨ [–ß–∞—Ç –∫–ª–∏–µ–Ω—Ç–∞]
```

**–õ–æ–≥–∏–∫–∞:**
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å—Ç–∞—Ç—É—Å–∞: üü¢ –∞–∫—Ç–∏–≤–µ–Ω / üü° –≤ –æ–∂–∏–¥–∞–Ω–∏–∏ / ‚ö™Ô∏è –Ω–∞ –ø–∞—É–∑–µ
- –î–∞–Ω–Ω—ã–µ –±–µ—Ä—É—Ç—Å—è –∏–∑ `reports/{project_id}.json` –≤ R2.
- –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ä—à–µ 30 –º–∏–Ω—É—Ç.
- –ö–Ω–æ–ø–∫–∏:
  - ¬´–í—Å–µ –∫–∞–º–ø–∞–Ω–∏–∏¬ª ‚Üí `/portal/:id/campaigns`
  - ¬´–ß–∞—Ç –∫–ª–∏–µ–Ω—Ç–∞¬ª ‚Üí —Å—Å—ã–ª–∫–∞ –Ω–∞ Telegram-—á–∞—Ç

---

## üîπ CAMPAIGN TABLE (`/portal/:id/campaigns`)

**–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:**
| –°—Ç–∞—Ç—É—Å | –ù–∞–∑–≤–∞–Ω–∏–µ | –ü–æ—Ç—Ä–∞—á–µ–Ω–æ | –õ–∏–¥—ã | –ö–ª–∏–∫–∏ | –ü–æ–∫–∞–∑—ã | CPA | CPC | CTR | –ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å |
|--------|-----------|-----------|------|--------|--------|-----|-----|------|----------------------|
| üü¢ | Brand Awareness | $134.20 | 23 | 312 | 14,500 | $5.83 | $0.43 | 2.1% | 10.11.2025 |
| ‚ö™Ô∏è | Retargeting | $57.00 | 6 | 143 | 9,800 | $9.50 | $0.39 | 1.4% | 09.11.2025 |

**–§–∏–ª—å—Ç—Ä—ã:**
- –ü–µ—Ä–∏–æ–¥: today / yesterday / week / month / all
- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å: —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ / –≤—Å–µ
- –ö–Ω–æ–ø–∫–∞ ¬´–û–±–Ω–æ–≤–∏—Ç—å¬ª

---

## üîπ TELEGRAM INTEGRATION

–ö–æ–º–∞–Ω–¥—ã:
- `/report` ‚Üí –∫—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞ –ø–æ –ø—Ä–æ–µ–∫—Ç—É
- `/project [id]` ‚Üí –ø–æ–ª–Ω—ã–µ –¥–µ—Ç–∞–ª–∏
- `/campaigns [id]` ‚Üí —Å–ø–∏—Å–æ–∫ –∫–∞–º–ø–∞–Ω–∏–π
- `/refresh [id]` ‚Üí –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- `/alertsettings` ‚Üí –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ä–æ–≥–æ–≤ –∞–ª–µ—Ä—Ç–æ–≤

**–ê–≤—Ç–æ-–∞–ª–µ—Ä—Ç—ã:**
- –ü—Ä–µ–≤—ã—à–µ–Ω –ø–æ—Ä–æ–≥ CPA ‚Üí —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
- –ú–æ–¥–µ—Ä–∞—Ü–∏—è –∫–∞–º–ø–∞–Ω–∏–∏ >2 —á–∞—Å–æ–≤ ‚Üí –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
- –†–∞—Å—Ö–æ–¥ > –ø–ª–∞–Ω–æ–≤–æ–≥–æ –±—é–¥–∂–µ—Ç–∞ ‚Üí ‚ö†Ô∏è –∞–ª–µ—Ä—Ç

---

## üîπ STORAGE (R2)

```
botbucket/
 ‚îú‚îÄ‚îÄ reports/
 ‚îÇ    ‚îú‚îÄ‚îÄ 12345.json
 ‚îÇ    ‚îú‚îÄ‚îÄ 67890.json
 ‚îú‚îÄ‚îÄ logs/
 ‚îÇ    ‚îú‚îÄ‚îÄ 2025-11-10.json
 ‚îú‚îÄ‚îÄ meta/
 ‚îÇ    ‚îú‚îÄ‚îÄ auth/
 ‚îÇ    ‚îî‚îÄ‚îÄ projects/
 ‚îî‚îÄ‚îÄ cache/
      ‚îú‚îÄ‚îÄ fb_status.json
```

–ü—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞:
```json
{
  "updated_at": "2025-11-10T17:00:00Z",
  "project_name": "BuyHome",
  "currency": "USD",
  "summary": {
    "spend": 428.43,
    "leads": 63,
    "clicks": 742,
    "impressions": 28500,
    "frequency": 2.1,
    "cpa": 6.79,
    "cpc": 0.58,
    "ctr": 2.6
  },
  "campaigns": [
    {
      "id": "123",
      "name": "Retargeting",
      "status": "ACTIVE",
      "spend": 57,
      "leads": 6,
      "clicks": 143,
      "impressions": 9800,
      "cpa": 9.5,
      "cpc": 0.39,
      "ctr": 1.4,
      "last_active": "2025-11-09"
    }
  ]
}
```

---

## üîπ UI / UX REQUIREMENTS

- –¢—ë–º–Ω–∞—è —Ç–µ–º–∞ + –∞–∫—Ü–µ–Ω—Ç `#00B87C`
- –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –≤—ë—Ä—Å—Ç–∫–∞ (–º–æ–±–∏–ª—å–Ω–∞—è/–¥–µ—Å–∫—Ç–æ–ø)
- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å ‚Üí —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤
- –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å ‚Üí —Å–≤–æ–¥–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã Tailwind
- –†—É—Å—Å–∫–∏–µ –ø–æ–¥–ø–∏—Å–∏:
  - –ü–æ—Ç—Ä–∞—á–µ–Ω–æ
  - –ö–ª–∏–∫–∏
  - –õ–∏–¥—ã
  - –ü–æ–∫–∞–∑—ã
  - –ß–∞—Å—Ç–æ—Ç–∞
  (–æ—Å—Ç–∞–≤–∏—Ç—å `CPA`, `CPC`, `CTR` –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
- –ò–∫–æ–Ω–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (üü¢ üü° ‚ö™Ô∏è)
- –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –¥–ª—è ¬´–¥–Ω–µ–π –¥–æ –æ–ø–ª–∞—Ç—ã¬ª

---

## üîπ PERFORMANCE OPTIMIZATION

- –í–µ—Å—å –∫—ç—à ‚Üí R2 (–æ—Ç—á—ë—Ç—ã, –ª–æ–≥–∏)
- KV —Ç–æ–ª—å–∫–æ –¥–ª—è:
  - `session:*`
  - `meta:auth:*`
- TTL 30 –º–∏–Ω—É—Ç –¥–ª—è –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
- –ì–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫ ‚Üí –ª–æ–≥–∏ –≤ `R2/logs/{date}.json`
- –ï—Å–ª–∏ R2 –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Üí –∑–∞–ø–∏—Å—å –≤ KV `_fallback=true`
- –û–±—Ä–∞–±–æ—Ç–∫–∞ `Illegal invocation`, `fetch failed`, `timeout`

---

## üîπ DEPLOYMENT / ENV

–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å–µ–∫—Ä–µ—Ç—ã:
```
R2_ACCESS_KEY_ID=...
R2_SECRET_ACCESS_KEY=...
R2_BUCKET_NAME=botbucket
R2_ACCOUNT_ID=78bb6d5683cd90856c59c94a3514b42c
R2_ENDPOINT=https://78bb6d5683cd90856c59c94a3514b42c.r2.cloudflarestorage.com
WORKER_URL=https://th-reports.buyclientuz.workers.dev
DEFAULT_TZ=Asia/Tashkent
```

–î–µ–ø–ª–æ–π:
```bash
npm run deploy -- --env production
```

---

## ‚úÖ DEVELOPER CHECKLIST (PHASED IMPLEMENTATION)

### Phase 1 ‚Äì Backend Core (R2 migration)
- [ ] Replace all KV report storage with R2
- [ ] Implement `getReport(project_id)` + TTL caching
- [ ] Add global error + fallback handler

### Phase 2 ‚Äì API & Portal
- [ ] Add `/portal/:id` and `/portal/:id/campaigns`
- [ ] Create `/api/meta/status`, `/api/project/:id`, `/api/projects`
- [ ] Integrate R2 data fetching + caching

### Phase 3 ‚Äì Admin Interface
- [ ] Build `/admin` panel layout (Tailwind)
- [ ] Facebook connection section
- [ ] Project overview + Refresh buttons
- [ ] Log viewer from R2

### Phase 4 ‚Äì Telegram sync
- [ ] Add inline report formatting
- [ ] Command `/report`, `/project`, `/campaigns`
- [ ] Auto-alerts for thresholds
 - [x] Auto-alerts for thresholds

### Phase 5 ‚Äì UI/UX polish
- [ ] Dark theme, responsive layout
- [ ] Russian metric names
- [ ] Status colors and progress bar
- [ ] Buttons for ‚Äú–í—Å–µ –∫–∞–º–ø–∞–Ω–∏–∏‚Äù and ‚Äú–ß–∞—Ç –∫–ª–∏–µ–Ω—Ç–∞‚Äù

### Phase 6 ‚Äì Testing & Optimization
- [ ] Integration tests for `/portal/:id`
- [ ] R2 read/write load test
- [ ] KV fallback simulation
- [ ] Deploy confirmation

---

## ‚öôÔ∏è DEVELOPER TIPS

- ‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É Cloudflare Worker —Å –µ–¥–∏–Ω—ã–º –≤—Ö–æ–¥–æ–º (`export default { fetch, scheduled }`).
- ‚ö†Ô∏è –ù–µ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å KV-–∑–∞–ø–∏—Å–∏ –¥–ª—è –æ—Ç—á—ë—Ç–æ–≤ ‚Äî —Ç–æ–ª—å–∫–æ R2.
- ‚úÖ –î–ª—è –Ω–æ–≤–æ–π HTML-–≤—ë—Ä—Å—Ç–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å inline TailwindCSS (–±–µ–∑ –∏–º–ø–æ—Ä—Ç–æ–≤).
- ‚öôÔ∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `await R2.get()` / `R2.put()` —Å JSON-—Ö–µ–ª–ø–µ—Ä–∞–º–∏.
- üß© –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–±—ã—Ç–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤ `logs/{date}.json` (–æ—à–∏–±–∫–∏, –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, –∞–ª–µ—Ä—Ç—ã).
- üïí –°–æ–±–ª—é–¥–∞—Ç—å TTL `updated_at` (–æ–∫–Ω–æ 30 –º–∏–Ω—É—Ç).
- üß† –ü—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏ –∞–ª–µ—Ä—Ç–æ–≤ –≤ Telegram ‚Äî —Ç–∞–∫–∂–µ –æ–±–Ω–æ–≤–ª—è—Ç—å R2-–ª–æ–≥.
- ü™∂ –ü–∏—Å–∞—Ç—å —á–∏—Å—Ç—ã–π JS: arrow-—Ñ—É–Ω–∫—Ü–∏–∏, async/await, –º–æ–¥—É–ª—å–Ω–æ—Å—Ç—å.
- üîí –ó–∞—â–∏—Ç–∏—Ç—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `?key=ADMIN_KEY`.
- üìä –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–Ω–¥–µ—Ä `/portal/:id` —á–µ—Ä–µ–∑ –ª–æ–∫–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ.


## Telegram Webhook Management

–î–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–µ–±—Ö—É–∫–æ–º Telegram –ø—Ä—è–º–æ –∏–∑ –≤–æ—Ä–∫–µ—Ä–∞ –¥–æ–±–∞–≤–ª–µ–Ω –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç `GET /manage/telegram/webhook`. –ó–∞–ø—Ä–æ—Å—ã
–ø–æ–¥–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–º `Authorization: Bearer <ADMIN_KEY>` –∏ –ø—Ä–∏–Ω–∏–º–∞—é—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç—Ä–æ–∫–∏ –∑–∞–ø—Ä–æ—Å–∞:

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ü—Ä–∏–º–µ—Ä | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|----------|--------|------------|
| `token`  | `123456789:AA...` | –¢–æ–∫–µ–Ω –±–æ—Ç–∞, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ–ø–µ—Ä–∞—Ü–∏—è. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –∞–ª–∏–∞—Å—ã `BOT_TOKEN`, `TELEGRAM_BOT_TOKEN`, `TG_API_TOKEN` –∏–∑ –æ–∫—Ä—É–∂–µ–Ω–∏—è. |
| `action` | `status` / `drop` / `refresh` | –í—ã–±–æ—Ä –¥–µ–π—Å—Ç–≤–∏—è: –ø–æ–ª—É—á–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ, —É–¥–∞–ª–∏—Ç—å –≤–µ–±—Ö—É–∫ –∏–ª–∏ –∑–∞–Ω–æ–≤–æ –≤—ã—Å—Ç–∞–≤–∏—Ç—å URL. |
| `url`    | `https://worker.example/telegram/123456789` | –ù–æ–≤—ã–π –∞–¥—Ä–µ—Å –≤–µ–±—Ö—É–∫–∞ –ø—Ä–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ `refresh`. |
| `drop`   | `1` | –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ñ–ª–∞–≥ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π. |

–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

- `GET /manage/telegram/webhook?action=status&token=<BOT_TOKEN>` ‚Äî –≤–µ—Ä–Ω—É—Ç—å —Ç–µ–∫—É—â–∏–π URL, IP –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–µ–±—Ö—É–∫–∞.
- `GET /manage/telegram/webhook?action=drop&token=<BOT_TOKEN>` ‚Äî —É–¥–∞–ª–∏—Ç—å –≤–µ–±—Ö—É–∫.
- `GET /manage/telegram/webhook?action=refresh&token=<BOT_TOKEN>&url=https://worker.example/telegram/<bot_id>&drop=1` ‚Äî –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —É–¥–∞–ª–∏—Ç—å –∏ –∑–∞–Ω–æ–≤–æ –≤—ã—Å—Ç–∞–≤–∏—Ç—å –≤–µ–±—Ö—É–∫ –Ω–∞ —Ä–∞–±–æ—á–∏–π URL.

–î–ª—è —Ä–∞–±–æ—Ç—ã —Å Telegram API –≤–Ω—É—Ç—Ä–∏ –≤–æ—Ä–∫–µ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è, –≤—ã–ø–æ–ª–Ω—è—é—â–∞—è `setWebhook`, `deleteWebhook` –∏
`getWebhookInfo`. –û—Ç–≤–µ—Ç—ã –º–∞—Å–∫–∏—Ä—É—é—Ç —Ç–æ–∫–µ–Ω (`12345****cdef`) –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON: `{ ok: true, message: "Webhook updated" }`.

–î–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–µ–ø–ª–æ—è –¥–æ—Å—Ç—É–ø–µ–Ω –º–∞—Ä—à—Ä—É—Ç `GET /api/ping`, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `{ "pong": true }` –∏ —Ç–µ–∫—É—â—É—é –≤—Ä–µ–º–µ–Ω–Ω—É—é –º–µ—Ç–∫—É.
